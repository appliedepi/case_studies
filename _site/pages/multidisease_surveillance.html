<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>multidisease_surveillance – Applied Epi Open Case Study Repository</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-8ea72dc5fed832574809a9c94082fbbb.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-aa61d32c583bf1dfab972411f0652ea9.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-f69cc4c4d15ad532714b0a0037dc36d7.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-YBNGPHQ4MK"></script>

<script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-YBNGPHQ4MK', { 'anonymize_ip': true});
</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"en"
  });
});
</script> 
  
<link href="../site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">

<script src="../site_libs/tabwid-1.1.3/tabwid.js"></script>



<link rel="stylesheet" href="webex.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Applied Epi Open Case Study Repository</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../pages/instructions.html"> 
<span class="menu-text">How-to Guide</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://appliedepi.org/"> 
<span class="menu-text">About Applied Epi</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://twitter.com/appliedepi" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-twitter"></i></a>
    <a href="https://www.linkedin.com/company/appliedepi/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-linkedin"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../images/logos/Applied_Epi_logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#multidisease_surveillance" id="toc-multidisease_surveillance" class="nav-link active" data-scroll-target="#multidisease_surveillance">Linking and analysing notification data and laboratory data in R</a>
  <ul class="collapse">
  <li><a href="#scenario" id="toc-scenario" class="nav-link" data-scroll-target="#scenario">Scenario</a></li>
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives">Objectives</a></li>
  <li><a href="#step-1.-set-up" id="toc-step-1.-set-up" class="nav-link" data-scroll-target="#step-1.-set-up">Step 1. Set up</a>
  <ul class="collapse">
  <li><a href="#get-started-in-rstudio" id="toc-get-started-in-rstudio" class="nav-link" data-scroll-target="#get-started-in-rstudio">1.1 Get started in RStudio</a></li>
  <li><a href="#installload-packages" id="toc-installload-packages" class="nav-link" data-scroll-target="#installload-packages">1.2 Install/load packages</a></li>
  </ul></li>
  <li><a href="#step-2.-download-and-import-the-data" id="toc-step-2.-download-and-import-the-data" class="nav-link" data-scroll-target="#step-2.-download-and-import-the-data">Step 2. Download and import the data</a>
  <ul class="collapse">
  <li><a href="#download-the-data" id="toc-download-the-data" class="nav-link" data-scroll-target="#download-the-data">2.1: Download the data</a></li>
  <li><a href="#import-the-data" id="toc-import-the-data" class="nav-link" data-scroll-target="#import-the-data">2.2 Import the data</a></li>
  </ul></li>
  <li><a href="#step-3.-inspect-the-data" id="toc-step-3.-inspect-the-data" class="nav-link" data-scroll-target="#step-3.-inspect-the-data">Step 3. Inspect the data</a>
  <ul class="collapse">
  <li><a href="#step-3.1-inspect-the-notification-data" id="toc-step-3.1-inspect-the-notification-data" class="nav-link" data-scroll-target="#step-3.1-inspect-the-notification-data">Step 3.1 Inspect the notification data</a></li>
  <li><a href="#step-3.2-inspect-the-laboratory-data" id="toc-step-3.2-inspect-the-laboratory-data" class="nav-link" data-scroll-target="#step-3.2-inspect-the-laboratory-data">Step 3.2 Inspect the laboratory data</a></li>
  </ul></li>
  <li><a href="#step-4.-clean-and-describe-the-notification-data" id="toc-step-4.-clean-and-describe-the-notification-data" class="nav-link" data-scroll-target="#step-4.-clean-and-describe-the-notification-data">Step 4. Clean and describe the notification data</a>
  <ul class="collapse">
  <li><a href="#step-4.1-clean-the-data" id="toc-step-4.1-clean-the-data" class="nav-link" data-scroll-target="#step-4.1-clean-the-data">Step 4.1 Clean the data</a></li>
  <li><a href="#step-4.2-simple-descriptive-analysis" id="toc-step-4.2-simple-descriptive-analysis" class="nav-link" data-scroll-target="#step-4.2-simple-descriptive-analysis">Step 4.2 Simple descriptive analysis</a></li>
  </ul></li>
  <li><a href="#step-5.-clean-consolidate-and-describe-the-laboratory-data" id="toc-step-5.-clean-consolidate-and-describe-the-laboratory-data" class="nav-link" data-scroll-target="#step-5.-clean-consolidate-and-describe-the-laboratory-data">Step 5. Clean, consolidate, and describe the laboratory data</a>
  <ul class="collapse">
  <li><a href="#step-5.1-standardise-the-test-results" id="toc-step-5.1-standardise-the-test-results" class="nav-link" data-scroll-target="#step-5.1-standardise-the-test-results">Step 5.1 Standardise the test results</a></li>
  <li><a href="#step-5.2-consolidate-to-one-row-per-test" id="toc-step-5.2-consolidate-to-one-row-per-test" class="nav-link" data-scroll-target="#step-5.2-consolidate-to-one-row-per-test">Step 5.2 Consolidate to one row per test</a></li>
  <li><a href="#step-5.3-simple-descriptive-analysis" id="toc-step-5.3-simple-descriptive-analysis" class="nav-link" data-scroll-target="#step-5.3-simple-descriptive-analysis">Step 5.3 Simple descriptive analysis</a></li>
  </ul></li>
  <li><a href="#step-6.-linkage-and-final-processing" id="toc-step-6.-linkage-and-final-processing" class="nav-link" data-scroll-target="#step-6.-linkage-and-final-processing">Step 6. Linkage and final processing</a>
  <ul class="collapse">
  <li><a href="#step-6.1-link-the-notification-data-and-lab-data" id="toc-step-6.1-link-the-notification-data-and-lab-data" class="nav-link" data-scroll-target="#step-6.1-link-the-notification-data-and-lab-data">Step 6.1 Link the notification data and lab data</a></li>
  <li><a href="#step-6.2-label-confirmed-discarded-and-suspected-cases" id="toc-step-6.2-label-confirmed-discarded-and-suspected-cases" class="nav-link" data-scroll-target="#step-6.2-label-confirmed-discarded-and-suspected-cases">Step 6.2 Label confirmed, discarded, and suspected cases</a></li>
  <li><a href="#step-6.3-review-the-distribution-of-laboratory-results-among-cases" id="toc-step-6.3-review-the-distribution-of-laboratory-results-among-cases" class="nav-link" data-scroll-target="#step-6.3-review-the-distribution-of-laboratory-results-among-cases">Step 6.3 Review the distribution of laboratory results among cases</a></li>
  <li><a href="#step-6.4-create-a-linelist-with-just-confirmed-cases" id="toc-step-6.4-create-a-linelist-with-just-confirmed-cases" class="nav-link" data-scroll-target="#step-6.4-create-a-linelist-with-just-confirmed-cases">Step 6.4 Create a linelist with just confirmed cases</a></li>
  </ul></li>
  <li><a href="#step-7.-descriptive-analysis-of-confirmed-cases" id="toc-step-7.-descriptive-analysis-of-confirmed-cases" class="nav-link" data-scroll-target="#step-7.-descriptive-analysis-of-confirmed-cases">Step 7. Descriptive analysis of confirmed cases</a>
  <ul class="collapse">
  <li><a href="#step-7.1-describe-cases-by-district" id="toc-step-7.1-describe-cases-by-district" class="nav-link" data-scroll-target="#step-7.1-describe-cases-by-district">Step 7.1 Describe cases by district</a></li>
  <li><a href="#step-7.2-describe-cases-over-time" id="toc-step-7.2-describe-cases-over-time" class="nav-link" data-scroll-target="#step-7.2-describe-cases-over-time">Step 7.2 Describe cases over time</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#data-cleaning-and-analysis-code" id="toc-data-cleaning-and-analysis-code" class="nav-link" data-scroll-target="#data-cleaning-and-analysis-code">Data cleaning and analysis code</a></li>
  <li><a href="#case-study-information" id="toc-case-study-information" class="nav-link" data-scroll-target="#case-study-information">Case study information</a></li>
  <li><a href="#terms-of-use" id="toc-terms-of-use" class="nav-link" data-scroll-target="#terms-of-use">Terms of Use</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header>




<section id="multidisease_surveillance" class="level1">
<h1>Linking and analysing notification data and laboratory data in R</h1>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Tool</strong>: R <strong>Technical complexity</strong>: Intermediate <strong>Methodological complexity</strong>: Basic</p>
<p><strong>Prior knowledge required:</strong> <a href="https://epirhandbook.com/en/new_pages/basics.html">R basics</a> (Using Rstudio; R packages, functions and arguments, using pipes) as well as key tidyverse functions and ggplots).</p>
<p><strong>Source:</strong> Applied Epi, with technical support provided by the CDC Global Surveillance, Laboratory, and Data Systems Branch in collaboration with TEPHINET.</p>
</div>
</div>
</div>
<p>For instructions on how to use our case studies, see our <a href="instructions.html">How-to Guide</a>. We welcome feedback and suggestions via <a href="mailto:contact@appliedepi.org">contact@appliedepi.org</a>. You can also discuss the case study or related concepts on the <a href="https://community.appliedepi.org/">Applied Epi Community</a>.</p>
<div style="page-break-after: always;"></div>
<section id="scenario" class="level2">
<h2 class="anchored" data-anchor-id="scenario">Scenario</h2>
<p>You are an epidemiologist working in the national surveillance office of Feveria, a very small tropical country. There are three districts within Feveria:</p>
<ul>
<li><strong>Feveria Central</strong>: an over-populated urban area, with sometimes unreliable water and sanitation infrastructure.</li>
<li><strong>Lake Minara</strong>: a lake area with good infrastructure but many mosquitoes in the warmer months of the year.</li>
<li><strong>Kasara</strong>: a more sub-urban area on the other side of Feveria Central.</li>
</ul>
<p><strong>Map of districts in the country Feveria</strong></p>
<p><img src="..\images/multidisease_surveillance/map_en.png" class="img-fluid" style="width:70.0%"></p>
<p>It is January 2025, and your supervisor would like you to transfer the routine processing of notifiable disease data from Excel into R, and to conduct some analyses on the data. She wants to know at least:</p>
<ul>
<li>How many suspected cases of the different notifiable diseases were reported in 2024, and which was most common?</li>
<li>What percentage of them ended up being confirmed?</li>
<li>How many confirmed cases of different notifiable diseases were reported in 2024, and which was most common?</li>
<li>How were confirmed cases geographically and temporally distributed in Feveria?</li>
</ul>
<p>She asks that you write code to import, clean, link, and analyse the following linelists:</p>
<ul>
<li><strong>2024 notifiable disease surveillance data:</strong> Referred to also as “notification data”, this is surveillance data on five notifiable diseases reported by clinics in Feveria: dengue, malaria, cholera, typhoid fever, and yellow fever. These are suspected cases, based on patients’ symptoms. Clinicians enter each notification into an online system every weekday.</li>
<li><strong>2024 laboratory test result data:</strong> This data comes from lab test results, from three major labs in Feveria. These results are for samples taken from those suspected notifiable disease cases mentioned above.</li>
</ul>
<p>Let’s go!</p>
</section>
<section id="objectives" class="level2">
<h2 class="anchored" data-anchor-id="objectives">Objectives</h2>
<p>In this case study you will:</p>
<ol type="1">
<li>Use key R functions to clean data, reshape datasets, link data sources, and create new columns using logical conditions to prepare data for analysis.</li>
<li>Conduct data inspections and data quality checks at multiple stages of the project and understand their importance for reliable analysis.</li>
<li>Perform basic descriptive analyses to compare disease trends across different data sources, before and after linkage.</li>
<li>Interpret differences in results across data sources and understand how these reflect the structure and design of the overall surveillance system.</li>
</ol>
</section>
<section id="step-1.-set-up" class="level2">
<h2 class="anchored" data-anchor-id="step-1.-set-up">Step 1. Set up</h2>
<section id="get-started-in-rstudio" class="level3">
<h3 class="anchored" data-anchor-id="get-started-in-rstudio">1.1 Get started in RStudio</h3>
<p>Start by setting up a reproducible and well-organized workflow. This will make it easy to rerun your analysis whenever needed.</p>
<p><strong>Tasks:</strong></p>
<ul>
<li>Set up an RStudio project</li>
<li>Set up clear sub-folders where your code, data, and outputs will go</li>
<li>Create an R script, or an R Markdown file if you prefer. Make sure the script purpose, date, and author are written as comments at the top.</li>
<li>Extra: Ensure your working language in RStudio is appropriate (e.g. English for this exercise)</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to read a hint
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p>Create a folder where all the work in this case study will go. For example, create ‘multi_disease_lab’ on your computer desktop. Create your RStudio project to be based in this folder.</p></li>
<li><p>We suggest creating the following sub-folders: <code>scripts</code> (for your code), <code>data</code> (for your data), and <code>outputs</code> (for your analytical outputs).</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the solution (try it yourself first!)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Create a folder (e.g.&nbsp;‘multi_disease_lab’ on your Desktop) for your work. To create an Rstudio project in your new folder, click <code>New Project…</code> in the top left of your R Studio, then <code>Existing Directory</code>, then <code>Browse</code> to select your new folder. For more information, look at the <a href="https://epirhandbook.com/new_pages/r_projects.html">R projects</a> section of the Epi R Handbook.</p>
<p>Start a new R script by clicking <code>New File</code> in the top left of your R Studio, then <code>R Script</code>. Save it immediately in the appropriate place, e.g.&nbsp;in a <code>scripts</code> sub-folder of your R Project.</p>
<p>At the top of your new R script, write some essential information like your name, the purpose of the file, and the date.</p>
<p>Your R locale determines the language and regional settings used for things like date formats and translations. If your locale is different from the language you want for your report (e.g., a French locale vs.&nbsp;an English report), you can change it to English by running <code>Sys.setlocale("LC_ALL", "English")</code>. Include this in your script if needed, or skip it if your locale is usually appropriate. This is explained in more detail in the <a href="pages/instructions.qmd_">How-to Guide</a>.</p>
</div>
</div>
</div>
</section>
<section id="installload-packages" class="level3">
<h3 class="anchored" data-anchor-id="installload-packages">1.2 Install/load packages</h3>
<p>Next in your R script, you need to install and load the necessary R packages. This ensures that the functions you need are available for your analysis.</p>
<p>You will need the following packages: <code>{rio}</code> (for importing data),<code>{skimr}</code> (for reviewing data), <code>{janitor}</code> (for cleaning data), <code>{lubridate}</code> (for cleaning dates), <code>{epikit}</code> (for epi-related tasks), <code>{gtsummary}</code> (for summary statistics/tests and regression), <code>{apyramid}</code> (for age-sex pyramids), <code>{flextable}</code> (for presentation-ready tables), <code>{naniar}</code> (for evaluating missing data), and <code>{tidyverse}</code> (for general data manipulation/science tasks).</p>
<p>You will also need the <code>{remotes}</code> package to download the data - which we will explain in the download section.</p>
<p>As you start, your trusted colleague nudges you and whispers “I’ve heard that a great way to manage your packages is with the <code>{pacman}</code> package”.</p>
<p>Over to you!</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the solution (try it yourself first!)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Use the function <code>p_load()</code> from <code>pacman</code> for this task. You provide the function with a list of packages that you want to use. The function will undertake two steps per package:</p>
<ol type="1">
<li><p>Check if the package is installed on your computer, and install it if necessary.</p></li>
<li><p>Load the package so it can be used during this R session.</p></li>
</ol>
<p>If you don’t already have <code>pacman</code> installed, you will need to install it the “traditional way” first, with <code>install.packages()</code>.</p>
<p>Note that the order of packages in your p_load function can be important. If two packages have the same function names (e.g.&nbsp;<code>select()</code> in the package <code>MASS</code> and <code>select()</code> in <code>tidyverse</code>, which do different things), then R will use the function from the most recently loaded package. To prioritize functions from <code>tidyverse</code>, which are commonly used for data manipulation and visualization, load <code>tidyverse</code> last.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensures the package "pacman" is installed</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">"pacman"</span>)) {</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>     <span class="fu">install.packages</span>(<span class="st">"pacman"</span>) }</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># install (if necessary) from CRAN and load packages to be used</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  rio,        <span class="co"># importing data  </span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  skimr,      <span class="co"># get overview of data</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  janitor,    <span class="co"># data cleaning and tables</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  lubridate,  <span class="co"># working with dates</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  epikit,     <span class="co"># to create age categories</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  gtsummary,  <span class="co"># summary statistics, tests and regressions </span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  apyramid,   <span class="co"># plotting age pyramids </span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  flextable,  <span class="co"># Presentation ready tables</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  naniar,     <span class="co"># Evaluating missingness of data</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  remotes,    <span class="co"># Used to install package to download data</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  tidyverse   <span class="co"># data management and visualization</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="step-2.-download-and-import-the-data" class="level2">
<h2 class="anchored" data-anchor-id="step-2.-download-and-import-the-data">Step 2. Download and import the data</h2>
<section id="download-the-data" class="level3">
<h3 class="anchored" data-anchor-id="download-the-data">2.1: Download the data</h3>
<p>Your office provides you with two files for your analysis, both containing data for 2024 and updated as of 15th January 2025:</p>
<ul>
<li>A disease notification-level dataset (<em>“multidisease_notifications.xlsx”</em>) with case information from 5 health centers.</li>
<li>A laboratory test-level dataset (<em>“multidisease_tests.csv”</em>) submitted by three laboratories conducting testing for the 5 health centers.</li>
</ul>
<p>For this case study, you can download the data via Applied Epi’s very useful data repository, which you can access using the <code>{appliedepidata}</code> package. Follow these steps:</p>
<ol type="1">
<li>Install the <code>{appliedepidata}</code> package from GitHub using the <code>install_github()</code> function in the <code>{remotes}</code> package (which you installed previously)</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the install_github function from remotes to install appliedepidata</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"appliedepi/appliedepidata"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>Save the two datasets into a specific folder using the <code>save_data()</code> function from <code>{appliedepidata}</code>, by running the code below. The example below saves the data into a <code>data</code> subfolder within the RStudio project. Note that if you do not specify a location within the <code>path</code> argument of the function, a window will pop up asking you to manually select a folder.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save down the two data files using the save_data() function from appliedepidata</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>appliedepidata<span class="sc">::</span><span class="fu">save_data</span>(<span class="st">"multidisease_tests"</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">path =</span> <span class="st">"data"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>appliedepidata<span class="sc">::</span><span class="fu">save_data</span>(<span class="st">"multidisease_notifications"</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">path =</span> <span class="st">"data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="import-the-data" class="level3">
<h3 class="anchored" data-anchor-id="import-the-data">2.2 Import the data</h3>
<p>Great! Thanks country office and Applied Epi! Now it’s time to import the data from that folder into RStudio, so you can analyse it.</p>
<section id="task-a-import-the-two-downloaded-data-files-into-your-r-studio-environment" class="level4">
<h4 class="anchored" data-anchor-id="task-a-import-the-two-downloaded-data-files-into-your-r-studio-environment"><strong>Task A: Import the two downloaded data files into your R Studio environment</strong></h4>
<p>Ideally, you will use the same function for importing both datasets, despite one being a .csv and the other an .xlsx file. Note going forward we will simply say “environment” when we mean the environment pane in R Studio.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to read a hint
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Use the <code>import</code> function from the <code>{rio}</code> package, which can recognize and import different file types. It replaces importing functions that are specific to the file type, such as <code>read.csv()</code> from <code>{base}</code> for .csv files and <code>read_excel()</code> from <code>{readxl}</code> to import .xlsx files.</p>
<p>If you feel you need to know more about importing functions, read the <a href="https://epirhandbook.com/new_pages/importing.html">Import and export</a> chapter of the Epi R Handbook.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the solution (try it yourself first!)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Below we use the import function to bring in both files. Note how we are assigning the imported data to two objects, one called <em>data_notif_raw</em>, and one called <em>data_lab_raw</em>. We add the ‘raw’ suffix to distinguish this data from the cleaned versions we will make later.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import data</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Notification data</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>data_notif_raw <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">"data/multidisease_notifications.xlsx"</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Lab data</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>data_lab_raw <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">"data/multidisease_tests.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="step-3.-inspect-the-data" class="level2">
<h2 class="anchored" data-anchor-id="step-3.-inspect-the-data">Step 3. Inspect the data</h2>
<p>The data’s in, and now it’s time to see what story it tells. Take an initial look at your two raw data frames to check their contents and quality.</p>
<section id="step-3.1-inspect-the-notification-data" class="level3">
<h3 class="anchored" data-anchor-id="step-3.1-inspect-the-notification-data">Step 3.1 Inspect the notification data</h3>
<section id="task-a-first-inspect-the-dimensions-and-general-contents-of-the-notification-data" class="level4">
<h4 class="anchored" data-anchor-id="task-a-first-inspect-the-dimensions-and-general-contents-of-the-notification-data"><strong>Task A: First, inspect the <em>dimensions</em> and general contents of the notification data</strong></h4>
<p><strong>Use <code>skim()</code> from the <code>{skimr}</code> package, <code>names()</code>, <code>ncol()</code>, and <code>nrow()</code> to inspect your data frame.</strong></p>
<p><code>skim()</code> gives you a lot of information on data structure and content, whereas <code>names()</code> will show you the different column names in your data. The <code>ncol()</code> and <code>nrow()</code> functions to simply count the numbers of columns and rows in the data. Do you know what to put inside the parentheses?</p>
<p>Easiest of all though, is to look at the environment. Remember the object in your environment for the notification data is called <code>data_notif_raw</code>.</p>
<p>Click on the solution box underneath the questions if you need help.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Questions
</div>
</div>
<div class="callout-body-container callout-body">
<div class="webex-check">
How many columns are there in the notification data?
<div id="radio_XRAXEUPGFL" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_XRAXEUPGFL" value=""> <span>10</span></label><label><input type="radio" autocomplete="off" name="radio_XRAXEUPGFL" value=""> <span>11</span></label><label><input type="radio" autocomplete="off" name="radio_XRAXEUPGFL" value="answer"> <span>12</span></label><label><input type="radio" autocomplete="off" name="radio_XRAXEUPGFL" value=""> <span>13</span></label>
</div>
Which of these columns are NOT in the data?
<div id="radio_ALCMXZSBHO" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_ALCMXZSBHO" value=""> <span>Onset date</span></label><label><input type="radio" autocomplete="off" name="radio_ALCMXZSBHO" value=""> <span>Date reported by Health Facility/Community</span></label><label><input type="radio" autocomplete="off" name="radio_ALCMXZSBHO" value=""> <span>Date of outcome</span></label><label><input type="radio" autocomplete="off" name="radio_ALCMXZSBHO" value="answer"> <span>Date of test</span></label><label><input type="radio" autocomplete="off" name="radio_ALCMXZSBHO" value=""> <span>Date of birth</span></label>
</div>
What is the name of the column in the notification data that identifies each notification?
<div id="radio_BDPUXCBDNF" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_BDPUXCBDNF" value="answer"> <span>Notification ID</span></label><label><input type="radio" autocomplete="off" name="radio_BDPUXCBDNF" value=""> <span>Test ID</span></label><label><input type="radio" autocomplete="off" name="radio_BDPUXCBDNF" value=""> <span>Health facility code</span></label><label><input type="radio" autocomplete="off" name="radio_BDPUXCBDNF" value=""> <span>Combination of Notification ID and Sex</span></label>
</div>
How many rows are there in the notification data?
<div id="radio_HJCDPCIHRG" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_HJCDPCIHRG" value="answer"> <span>987</span></label><label><input type="radio" autocomplete="off" name="radio_HJCDPCIHRG" value=""> <span>1314</span></label><label><input type="radio" autocomplete="off" name="radio_HJCDPCIHRG" value=""> <span>950</span></label><label><input type="radio" autocomplete="off" name="radio_HJCDPCIHRG" value=""> <span>778</span></label>
</div>
What type of information can you NOT see in the notification data?
<div id="radio_HLLFVMSRFH" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_HLLFVMSRFH" value="answer"> <span>Laboratory test results</span></label><label><input type="radio" autocomplete="off" name="radio_HLLFVMSRFH" value=""> <span>District of residence</span></label><label><input type="radio" autocomplete="off" name="radio_HLLFVMSRFH" value=""> <span>Birthday and sex</span></label><label><input type="radio" autocomplete="off" name="radio_HLLFVMSRFH" value=""> <span>Health facility in which the case was diagnosed</span></label><label><input type="radio" autocomplete="off" name="radio_HLLFVMSRFH" value=""> <span>Outcome</span></label>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the solution (try it yourself first!)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Use <code>skim()</code> from the <code>{skimr}</code> package to look at a summary of the entire data frame, and <code>View()</code> to look at the whole data frame directly:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(data_notif_raw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Or, you could use <code>names()</code> to print out just the column names. Through either <code>skim()</code> or <code>names()</code> you will be able to see the types of information including: the health facility of the case, birth-date, sex, a flag indicating pregnancy, district of residence, onset date, and date reported by the clinic, and outcome information.</p>
<p>There is also a <code>Notification ID</code> which appears to be a unique identifier for a case, but we would want to double check duplicates before we are sure.</p>
<p>Note that there are NO test results in this data, as these notifications are from clinics diagnosing notifiable diseases based on clinical case definitions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(data_notif_raw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Organisation unit name"                    
 [2] "Health facility code"                      
 [3] "Notification ID"                           
 [4] "Date of Birth"                             
 [5] "Sex"                                       
 [6] "Pregnant"                                  
 [7] "Residential District"                      
 [8] "Disease notified"                          
 [9] "Onset date"                                
[10] "Date reported by Health Facility/Community"
[11] "Outcome"                                   
[12] "Date of outcome"                           </code></pre>
</div>
</div>
<p>Use <code>ncol()</code> and <code>nrow()</code> to print the number of columns and rows, like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(data_notif_raw)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(data_notif_raw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This will print the numbers of columns and rows in your console.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 987</code></pre>
</div>
</div>
<p>Otherwise, when you look at the environment you can see that the number of observations (which is the same as rows) and columns are listed next to the name of the data frame.</p>
</div>
</div>
</div>
</section>
<section id="task-b-next-look-at-the-classes-of-columns-in-your-raw-notification-data-frame" class="level4">
<h4 class="anchored" data-anchor-id="task-b-next-look-at-the-classes-of-columns-in-your-raw-notification-data-frame"><strong>Task B: Next, look at the classes of columns in your raw notification data frame</strong></h4>
<p><strong>Use <code>skim()</code> from the <code>{skimr}</code> package or <code>class()</code> to inspect your column classes.</strong></p>
<p>Do you remember how to specify the column of interest inside the <code>class()</code> function? Alternatively, you can just look at the environment.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Questions
</div>
</div>
<div class="callout-body-container callout-body">
<div class="webex-check">
How many columns in the notification data frame are recognised by R to be date columns?
<div id="radio_KAHEPLWCVF" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_KAHEPLWCVF" value="answer"> <span>0</span></label><label><input type="radio" autocomplete="off" name="radio_KAHEPLWCVF" value=""> <span>2</span></label><label><input type="radio" autocomplete="off" name="radio_KAHEPLWCVF" value=""> <span>4</span></label>
</div>
What is the class of most columns in the raw notification data frame?
<div id="radio_LRBPPBXVPR" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_LRBPPBXVPR" value="answer"> <span>character</span></label><label><input type="radio" autocomplete="off" name="radio_LRBPPBXVPR" value=""> <span>numeric</span></label><label><input type="radio" autocomplete="off" name="radio_LRBPPBXVPR" value=""> <span>factor</span></label>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the solution (try it yourself first!)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>You can use <code>class</code> like the example below. The <code>$</code> is an operator used to select a specific column from the <code>data_notif_raw</code> data frame.</p>
<p>Note that the back-ticks (<code>`</code>) are used around <code>Date of Birth</code> because the column name contains spaces.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(data_notif_raw<span class="sc">$</span><span class="st">`</span><span class="at">Date of Birth</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To look at class via the environment, click on the blue arrow next to the data frame name. The column names will appear, with the class next to it (e.g.&nbsp;it says “chr” to show character class).</p>
<p>You can see the none of the columns that should be dates are recognized as dates. Instead, they are recognized as character values.</p>
</div>
</div>
</div>
</section>
<section id="task-c-inspect-categorical-values-and-missingness" class="level4">
<h4 class="anchored" data-anchor-id="task-c-inspect-categorical-values-and-missingness"><strong>Task C: Inspect categorical values and missingness</strong></h4>
<p><strong>Use the <code>tabyl()</code> function to inspect the values within categorical columns</strong>, specifying the data frame object in the first argument, and the column name in the second argument.</p>
<p>For example, this code tabulates the values for the <code>Sex</code> column. The output shows that male and female are inconsistently spelled across the data. This column would need further cleaning before analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(data_notif_raw, Sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Sex   n    percent valid_percent
      F  47 0.04761905    0.05452436
 FEMALE 146 0.14792300    0.16937355
      M  40 0.04052685    0.04640371
   MALE 172 0.17426545    0.19953596
      f 154 0.15602837    0.17865429
 female  98 0.09929078    0.11368910
      m 119 0.12056738    0.13805104
   male  86 0.08713273    0.09976798
   &lt;NA&gt; 125 0.12664640            NA</code></pre>
</div>
</div>
<p>To inspect missingness, you can use the <code>miss_var_summary()</code> function from the <code>{naniar}</code> package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_var_summary</span>(data_notif_raw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 3
   variable                                   n_miss pct_miss
   &lt;chr&gt;                                       &lt;int&gt;    &lt;num&gt;
 1 Onset date                                    691     70.0
 2 Pregnant                                      510     51.7
 3 Outcome                                       197     20.0
 4 Date of outcome                               197     20.0
 5 Date of Birth                                 168     17.0
 6 Sex                                           125     12.7
 7 Organisation unit name                          0      0  
 8 Health facility code                            0      0  
 9 Notification ID                                 0      0  
10 Residential District                            0      0  
11 Disease notified                                0      0  
12 Date reported by Health Facility/Community      0      0  </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Questions
</div>
</div>
<div class="callout-body-container callout-body">
<div class="webex-check">
Are the values in the <code>Residential District</code> column standardized?
<div id="radio_LBGBXUKPSJ" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_LBGBXUKPSJ" value="answer"> <span>No - they need cleaning</span></label><label><input type="radio" autocomplete="off" name="radio_LBGBXUKPSJ" value=""> <span>They are standardized and are ready to be used for analysis</span></label>
</div>
Are the values in the <code>Disease notified</code> column standardized?
<div id="radio_BXZUISAYOO" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_BXZUISAYOO" value=""> <span>No - they need cleaning</span></label><label><input type="radio" autocomplete="off" name="radio_BXZUISAYOO" value="answer"> <span>They are standardized and are ready to be used for analysis</span></label>
</div>
What does R recognise as a missing value?
<div id="radio_TUVQZIDBAA" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_TUVQZIDBAA" value=""> <span>Either no value, or just a space, or just a dot</span></label><label><input type="radio" autocomplete="off" name="radio_TUVQZIDBAA" value="answer"> <span>No value in a cell, represented with NA</span></label><label><input type="radio" autocomplete="off" name="radio_TUVQZIDBAA" value=""> <span>The words Unknown and Uncertain</span></label>
</div>
Based on the missingness of its values, is the <code>Onset date</code> column useful?
<div id="radio_ZFNWANBTYT" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_ZFNWANBTYT" value=""> <span>Yes, the missingness is low so this column is useful</span></label><label><input type="radio" autocomplete="off" name="radio_ZFNWANBTYT" value="answer"> <span>Minimally, as the missingness is too high</span></label>
</div>
Why might some columns in the notification data have different spellings and non-standardized categories?
<div id="radio_EEUWPQSQDB" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_EEUWPQSQDB" value=""> <span>A bot scrambles the data so it becomes less identifiable</span></label><label><input type="radio" autocomplete="off" name="radio_EEUWPQSQDB" value="answer"> <span>Each clinic might use software that is configured slightly differently, or use free-text entries, so there are variations in spelling</span></label><label><input type="radio" autocomplete="off" name="radio_EEUWPQSQDB" value=""> <span>The surveillance system software used by the clinical settings has lots of bugs</span></label>
</div>
Why might some columns in the notification data have high missingness?
<div id="radio_WBXWRCULPI" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_WBXWRCULPI" value=""> <span>The clinician does not ask the patient the question during their consultation</span></label><label><input type="radio" autocomplete="off" name="radio_WBXWRCULPI" value=""> <span>The patient might not know or want to share the answer</span></label><label><input type="radio" autocomplete="off" name="radio_WBXWRCULPI" value=""> <span>The clinician might not have time to prioritise filling in that field in the data, even if they know the information</span></label><label><input type="radio" autocomplete="off" name="radio_WBXWRCULPI" value="answer"> <span>All of the above, and many more reasons</span></label>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the solution (try it yourself first!)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Use the <code>tabyl()</code> function to tabulate the values within the <code>Residential District</code> column. Again, the first argument is the name of the data frame object, and the second argument is the name of the column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(data_notif_raw, <span class="st">`</span><span class="at">Residential District</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Residential District   n    percent
            F Central  32 0.03242148
            FEVERIA C  23 0.02330294
      FEVERIA CENTRAL  85 0.08611955
            Feveria C  24 0.02431611
      Feveria Central  12 0.01215805
               KASARA  64 0.06484296
                  KSR  17 0.01722391
               Kasara 109 0.11043566
             L MINARA  50 0.05065856
             L Minara 193 0.19554205
          LAKE MINARA 185 0.18743668
          Lake Minara  68 0.06889564
             Lakeside 125 0.12664640</code></pre>
</div>
</div>
<p>You can see that each of the three locations (Feveria Central, Lake Minara, and Kasara) are spelled in different ways and with different capitalization. This will need to be cleaned out if we want to analyse the geographic distribution of the notifiable diseases.</p>
<p>Similarly, use the <code>tabyl()</code> function to tabulate the values within the <code>Disease notified</code> column. You can see these are spelled out appropriately and consistently, so you can already see the distribution of rows by disease without further cleaning.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(data_notif_raw, <span class="st">`</span><span class="at">Disease notified</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Disease notified   n    percent
          cholera  46 0.04660588
           dengue 273 0.27659574
          malaria 533 0.54002026
          typhoid  35 0.03546099
     yellow fever 100 0.10131712</code></pre>
</div>
</div>
<p>A different way of checking missingness is to tabulate the output of the function <code>is.na()</code>. In the example below, the function <code>is.na()</code> evaluates each cell within the column <code>Onset date</code>, returning TRUE for missing ones and FALSE for present ones.</p>
<p>Running <code>tabyl()</code> on this TRUE/FALSE output then quickly gives you a clear count and percentage of both missing and non-missing values in that column. Remember, values like a space or the words “Unknown” or “Missing” will not be recognized by R as missing. R will only recognize true blanks as missing, represented by <code>NA</code>.</p>
<p>For <code>Onset date</code>, you can see that 70% of cases are missing onset date, suggesting that this column would not be particularly useful for analyzing trends in disease over time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(<span class="fu">is.na</span>(data_notif_raw<span class="sc">$</span><span class="st">`</span><span class="at">Onset date</span><span class="st">`</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> is.na(data_notif_raw$`Onset date`)   n   percent
                              FALSE 296 0.2998987
                               TRUE 691 0.7001013</code></pre>
</div>
</div>
<p>Missing or non-standardized data can arise for many reasons, including:</p>
<ul>
<li><p>the design of the data collection tool (e.g.&nbsp;whether questions are mandatory or use free text vs.&nbsp;drop-downs),</p></li>
<li><p>the processes and standards in place (such as which fields staff are instructed to prioritise), and</p></li>
<li><p>contextual factors (like whether staff have sufficient time to gather the information).</p></li>
</ul>
</div>
</div>
</div>
</section>
</section>
<section id="step-3.2-inspect-the-laboratory-data" class="level3">
<h3 class="anchored" data-anchor-id="step-3.2-inspect-the-laboratory-data">Step 3.2 Inspect the laboratory data</h3>
<section id="task-a-inspect-the-dimensions-and-general-content-of-the-lab-data" class="level4">
<h4 class="anchored" data-anchor-id="task-a-inspect-the-dimensions-and-general-content-of-the-lab-data"><strong>Task A: Inspect the <em>dimensions</em> and general content of the lab data</strong></h4>
<p>Like with the notification data, <strong>use <code>skim()</code>, <code>ncol()</code>, and <code>nrow()</code> functions or check the environment to inspect the lab data.</strong></p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Questions
</div>
</div>
<div class="callout-body-container callout-body">
<div class="webex-check">
Which linelist has more columns - the notification data or the laboratory data?
<div id="radio_KJKXMRBOUV" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_KJKXMRBOUV" value=""> <span>Lab data</span></label><label><input type="radio" autocomplete="off" name="radio_KJKXMRBOUV" value="answer"> <span>Notification data</span></label><label><input type="radio" autocomplete="off" name="radio_KJKXMRBOUV" value=""> <span>They have the same number of columns</span></label>
</div>
Which linelist has more rows?
<div id="radio_JDIGGYXDOU" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_JDIGGYXDOU" value="answer"> <span>Lab data</span></label><label><input type="radio" autocomplete="off" name="radio_JDIGGYXDOU" value=""> <span>Notification data</span></label><label><input type="radio" autocomplete="off" name="radio_JDIGGYXDOU" value=""> <span>They have the same number of rows</span></label>
</div>
Inspect the lab data with <code>View()</code>. Why might the lab data have more records?
<div id="radio_UGKRMANMGK" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_UGKRMANMGK" value="answer"> <span>There may be several tests or targets per sample</span></label><label><input type="radio" autocomplete="off" name="radio_UGKRMANMGK" value=""> <span>There are so many trial test results in the data</span></label><label><input type="radio" autocomplete="off" name="radio_UGKRMANMGK" value=""> <span>Not all the notifications have test results yet</span></label>
</div>
Which of these columns are NOT in the lab data?
<div id="radio_LUAFETMQGZ" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_LUAFETMQGZ" value=""> <span>Notification ID</span></label><label><input type="radio" autocomplete="off" name="radio_LUAFETMQGZ" value=""> <span>Sample ID</span></label><label><input type="radio" autocomplete="off" name="radio_LUAFETMQGZ" value=""> <span>Test type</span></label><label><input type="radio" autocomplete="off" name="radio_LUAFETMQGZ" value="answer"> <span>Date of birth</span></label><label><input type="radio" autocomplete="off" name="radio_LUAFETMQGZ" value=""> <span>Test result</span></label>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the solution (try it yourself first!)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Just like in section 3.1, you can use <code>skim()</code> from the <code>{skimr}</code> package to look at the entire laboratory data frame with test results. This will also show you the different column names in the data, showing you that the lab data only contains information about the test and not about the patient. It does however also contain a <strong>notification ID</strong>, just like the notification data does.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(data_lab_raw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Use <code>ncol()</code> and <code>nrow()</code> to print the number of columns and rows, like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(data_lab_raw)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(data_lab_raw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This will print the numbers of columns and rows in your console, showing you that the lab data has more rows than the notification data you inspected earlier.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1314</code></pre>
</div>
</div>
<p>There are often more records in the lab data than in the clinical data. If you inspect the data with <code>View(data_lab_raw)</code> and then click on the arrow at the top of the <code>notification_id</code> column to sort it alphabetically, you’ll see that several rows share the same <code>notification_id</code>. This can happen when multiple targets are tested from the same sample (same sample ID), or when a case is retested (resulting in a different sample ID).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(data_lab_raw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-f8f0179c{}.cl-f8df3440{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f8e76bb0{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f8e76bba{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f8e7a3e6{width:1.975in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f8e7a3f0{width:1.219in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f8e7a3fa{width:0.982in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f8e7a3fb{width:1.067in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f8e7a404{width:1.746in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f8e7a405{width:1.202in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f8e7a418{width:0.65in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f8e7a422{width:1.975in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f8e7a423{width:1.219in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f8e7a424{width:0.982in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f8e7a42c{width:1.067in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f8e7a436{width:1.746in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f8e7a437{width:1.202in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f8e7a438{width:0.65in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f8e7a440{width:1.975in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f8e7a44a{width:1.219in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f8e7a44b{width:0.982in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f8e7a454{width:1.067in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f8e7a45e{width:1.746in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f8e7a45f{width:1.202in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f8e7a460{width:0.65in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-f8f0179c"><thead><tr style="overflow-wrap:break-word;"><th class="cl-f8e7a3e6"><p class="cl-f8e76bb0"><span class="cl-f8df3440">laboratory_name</span></p></th><th class="cl-f8e7a3f0"><p class="cl-f8e76bb0"><span class="cl-f8df3440">notification_id</span></p></th><th class="cl-f8e7a3fa"><p class="cl-f8e76bb0"><span class="cl-f8df3440">sample_id</span></p></th><th class="cl-f8e7a3fb"><p class="cl-f8e76bba"><span class="cl-f8df3440">date_test</span></p></th><th class="cl-f8e7a404"><p class="cl-f8e76bb0"><span class="cl-f8df3440">test</span></p></th><th class="cl-f8e7a405"><p class="cl-f8e76bb0"><span class="cl-f8df3440">target</span></p></th><th class="cl-f8e7a418"><p class="cl-f8e76bb0"><span class="cl-f8df3440">value</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-f8e7a422"><p class="cl-f8e76bb0"><span class="cl-f8df3440">Feveria General Hospital</span></p></td><td class="cl-f8e7a423"><p class="cl-f8e76bb0"><span class="cl-f8df3440">f21708</span></p></td><td class="cl-f8e7a424"><p class="cl-f8e76bb0"><span class="cl-f8df3440">48b00313</span></p></td><td class="cl-f8e7a42c"><p class="cl-f8e76bba"><span class="cl-f8df3440">2024-06-07</span></p></td><td class="cl-f8e7a436"><p class="cl-f8e76bb0"><span class="cl-f8df3440">Dengue NS1/IgG/IgM</span></p></td><td class="cl-f8e7a437"><p class="cl-f8e76bb0"><span class="cl-f8df3440">Dengue NS.1</span></p></td><td class="cl-f8e7a438"><p class="cl-f8e76bb0"><span class="cl-f8df3440">N</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f8e7a422"><p class="cl-f8e76bb0"><span class="cl-f8df3440">Feveria General Hospital</span></p></td><td class="cl-f8e7a423"><p class="cl-f8e76bb0"><span class="cl-f8df3440">f21708</span></p></td><td class="cl-f8e7a424"><p class="cl-f8e76bb0"><span class="cl-f8df3440">48b00313</span></p></td><td class="cl-f8e7a42c"><p class="cl-f8e76bba"><span class="cl-f8df3440">2024-06-07</span></p></td><td class="cl-f8e7a436"><p class="cl-f8e76bb0"><span class="cl-f8df3440">Dengue NS1/IgG/IgM</span></p></td><td class="cl-f8e7a437"><p class="cl-f8e76bb0"><span class="cl-f8df3440">Dengue IgG</span></p></td><td class="cl-f8e7a438"><p class="cl-f8e76bb0"><span class="cl-f8df3440">N</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f8e7a422"><p class="cl-f8e76bb0"><span class="cl-f8df3440">Feveria General Hospital</span></p></td><td class="cl-f8e7a423"><p class="cl-f8e76bb0"><span class="cl-f8df3440">f21708</span></p></td><td class="cl-f8e7a424"><p class="cl-f8e76bb0"><span class="cl-f8df3440">48b00313</span></p></td><td class="cl-f8e7a42c"><p class="cl-f8e76bba"><span class="cl-f8df3440">2024-06-07</span></p></td><td class="cl-f8e7a436"><p class="cl-f8e76bb0"><span class="cl-f8df3440">Dengue NS1/IgG/IgM</span></p></td><td class="cl-f8e7a437"><p class="cl-f8e76bb0"><span class="cl-f8df3440">Dengue IgM</span></p></td><td class="cl-f8e7a438"><p class="cl-f8e76bb0"><span class="cl-f8df3440">P</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f8e7a422"><p class="cl-f8e76bb0"><span class="cl-f8df3440">Feveria General Hospital</span></p></td><td class="cl-f8e7a423"><p class="cl-f8e76bb0"><span class="cl-f8df3440">6a47a3</span></p></td><td class="cl-f8e7a424"><p class="cl-f8e76bb0"><span class="cl-f8df3440">ca5e865b</span></p></td><td class="cl-f8e7a42c"><p class="cl-f8e76bba"><span class="cl-f8df3440">2024-06-15</span></p></td><td class="cl-f8e7a436"><p class="cl-f8e76bb0"><span class="cl-f8df3440">Dengue NS1/IgG/IgM</span></p></td><td class="cl-f8e7a437"><p class="cl-f8e76bb0"><span class="cl-f8df3440">Dengue NS.1</span></p></td><td class="cl-f8e7a438"><p class="cl-f8e76bb0"><span class="cl-f8df3440">N</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f8e7a422"><p class="cl-f8e76bb0"><span class="cl-f8df3440">Feveria General Hospital</span></p></td><td class="cl-f8e7a423"><p class="cl-f8e76bb0"><span class="cl-f8df3440">6a47a3</span></p></td><td class="cl-f8e7a424"><p class="cl-f8e76bb0"><span class="cl-f8df3440">ca5e865b</span></p></td><td class="cl-f8e7a42c"><p class="cl-f8e76bba"><span class="cl-f8df3440">2024-06-15</span></p></td><td class="cl-f8e7a436"><p class="cl-f8e76bb0"><span class="cl-f8df3440">Dengue NS1/IgG/IgM</span></p></td><td class="cl-f8e7a437"><p class="cl-f8e76bb0"><span class="cl-f8df3440">Dengue IgG</span></p></td><td class="cl-f8e7a438"><p class="cl-f8e76bb0"><span class="cl-f8df3440">N</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f8e7a440"><p class="cl-f8e76bb0"><span class="cl-f8df3440">Feveria General Hospital</span></p></td><td class="cl-f8e7a44a"><p class="cl-f8e76bb0"><span class="cl-f8df3440">6a47a3</span></p></td><td class="cl-f8e7a44b"><p class="cl-f8e76bb0"><span class="cl-f8df3440">ca5e865b</span></p></td><td class="cl-f8e7a454"><p class="cl-f8e76bba"><span class="cl-f8df3440">2024-06-15</span></p></td><td class="cl-f8e7a45e"><p class="cl-f8e76bb0"><span class="cl-f8df3440">Dengue NS1/IgG/IgM</span></p></td><td class="cl-f8e7a45f"><p class="cl-f8e76bb0"><span class="cl-f8df3440">Dengue IgM</span></p></td><td class="cl-f8e7a460"><p class="cl-f8e76bb0"><span class="cl-f8df3440">P</span></p></td></tr></tbody></table></div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="task-b-look-at-the-classes-categorical-values-and-missingness" class="level4">
<h4 class="anchored" data-anchor-id="task-b-look-at-the-classes-categorical-values-and-missingness"><strong>Task B: Look at the classes, categorical values, and missingness</strong></h4>
<p>As above, <strong>use the <code>class()</code>, <code>skim()</code>, or <code>tabyl()</code> functions, or inspect the environment, to look at your columns in more detail.</strong></p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Questions
</div>
</div>
<div class="callout-body-container callout-body">
<div class="webex-check">
How many columns in the laboratory data frame are recognised by R to be date columns?
<div id="radio_ZDJDPMOHDW" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_ZDJDPMOHDW" value=""> <span>0</span></label><label><input type="radio" autocomplete="off" name="radio_ZDJDPMOHDW" value="answer"> <span>1</span></label><label><input type="radio" autocomplete="off" name="radio_ZDJDPMOHDW" value=""> <span>2</span></label>
</div>
How many columns in the laboratory data frame have complete data?
<div id="radio_XLIKQNRANU" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_XLIKQNRANU" value=""> <span>1</span></label><label><input type="radio" autocomplete="off" name="radio_XLIKQNRANU" value=""> <span>3</span></label><label><input type="radio" autocomplete="off" name="radio_XLIKQNRANU" value="answer"> <span>7 (all of them!)</span></label>
</div>
Which test detects multiple targets (and therefore has multiple rows per sample)?
<div id="radio_VGVUVVWMPD" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_VGVUVVWMPD" value=""> <span>Malaria</span></label><label><input type="radio" autocomplete="off" name="radio_VGVUVVWMPD" value="answer"> <span>Dengue</span></label><label><input type="radio" autocomplete="off" name="radio_VGVUVVWMPD" value=""> <span>Yellow Fever</span></label><label><input type="radio" autocomplete="off" name="radio_VGVUVVWMPD" value=""> <span>Cholera</span></label><label><input type="radio" autocomplete="off" name="radio_VGVUVVWMPD" value=""> <span>Typhoid Fever</span></label>
</div>
How many possible test result values are there in the column <code>value</code>?
<div id="radio_PFGFMJZRZR" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_PFGFMJZRZR" value="answer"> <span>5</span></label><label><input type="radio" autocomplete="off" name="radio_PFGFMJZRZR" value=""> <span>3</span></label><label><input type="radio" autocomplete="off" name="radio_PFGFMJZRZR" value=""> <span>4</span></label>
</div>
What is NOT a possible test result for the stool culture test which detects V. cholerae bacteria?
<div id="radio_IFVPTTMACT" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_IFVPTTMACT" value="answer"> <span>P</span></label><label><input type="radio" autocomplete="off" name="radio_IFVPTTMACT" value=""> <span>P01</span></label><label><input type="radio" autocomplete="off" name="radio_IFVPTTMACT" value=""> <span>P0139</span></label><label><input type="radio" autocomplete="off" name="radio_IFVPTTMACT" value=""> <span>N</span></label><label><input type="radio" autocomplete="off" name="radio_IFVPTTMACT" value=""> <span>I</span></label>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the solution (try it yourself first!)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The laboratory data has one date column, recognized by R as an “IDate” class. This is a date class used by <code>{rio}</code>’s <code>import()</code> when reading csv files. Like base R’s Date class, it allows sorting by date and analyzing trends over time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(data_lab_raw<span class="sc">$</span>date_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "IDate" "Date" </code></pre>
</div>
</div>
<p>Use of the <code>miss_var_summary()</code> function from the <code>{naniar}</code> package demonstrates that all columns in the laboratory data are actually complete. This may be because the laboratory systems use automated processes, so are much less likely to have human error.</p>
<p>(<strong>Important point</strong>: Note that in real life, the lab data would probably have some issues too!)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_var_summary</span>(data_lab_raw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 3
  variable        n_miss pct_miss
  &lt;chr&gt;            &lt;int&gt;    &lt;num&gt;
1 laboratory_name      0        0
2 notification_id      0        0
3 sample_id            0        0
4 date_test            0        0
5 test                 0        0
6 target               0        0
7 value                0        0</code></pre>
</div>
</div>
<p>To see how many targets are detected by each test, you can cross-tabulate <code>test</code> and <code>target</code> columns with <code>tabyl()</code>. Write the column names into the function as two separate arguments. The output shows that each test clearly aligns with one or more targets, and only the dengue assay detects more than one target (IgG, IgM, and NS.1).</p>
<p><strong>Tip:</strong> Experiment with changing the order of the column names in the function to see the impact on the table.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(data_lab_raw, target, test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               target Blood culture Dengue NS1/IgG/IgM IgM ELISA Stool Culture
           Dengue IgG             0                215         0             0
           Dengue IgM             0                215         0             0
          Dengue NS.1             0                215         0             0
           Plasmodium             0                  0         0             0
    S. Typhi bacteria            33                  0         0             0
 V. cholerae bacteria             0                  0         0            45
     Yellow Fever IgM             0                  0        88             0
 Whole Blood Microscopy
                      0
                      0
                      0
                    503
                      0
                      0
                      0</code></pre>
</div>
</div>
<p>Finally, you can inspect the different test result values in the column <code>value</code>, again using <code>tabyl()</code>. You can see that there are six possible results, including N for negative, P for positive, and I for indeterminate. Cholera specifically does not show P, but can show P01 and P0139, which in this case represent being positive for serogroups O1 or O139.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(data_lab_raw, test, value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   test  I   N   P PO1 PO139
          Blood culture  2  24   7   0     0
     Dengue NS1/IgG/IgM  0 354 291   0     0
              IgM ELISA 10  45  33   0     0
          Stool Culture  5   2   0  22    16
 Whole Blood Microscopy 56 257 190   0     0</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="step-4.-clean-and-describe-the-notification-data" class="level2">
<h2 class="anchored" data-anchor-id="step-4.-clean-and-describe-the-notification-data">Step 4. Clean and describe the notification data</h2>
<p>You now know that the notification data (<code>data_notif_raw</code>) contains information about suspected cases, alongside basic demographic information (age, sex, pregnancy, district of residence), and information about their onset date, date reported by the health facility, and outcome. Some columns need cleaning before further analysis, due to variations in spelling of categorical values and some date columns not being recognized as dates.</p>
<p>You will now start writing longer chunks of code to clean data, using various <code>{dplyr}</code> functions chained together with pipes (which look like this: |&gt;).</p>
<p><strong>NOTE ON PIPES</strong>: Pipes allow you to perform several operations in one smooth sequence, by “chaining” different functions together. The output from one function becomes the input for the next.</p>
<p>If you need more information on piping, please refer to the <a href="https://www.epirhandbook.com/en/new_pages/cleaning.html#cleaning-pipeline">Epi R Handbook</a>.</p>
<p>Note that this exercise uses the <strong>base pipe</strong> (<code>|&gt;</code>) rather than the <strong>magrittr pipe</strong> (<code>%&gt;%</code>), as it is faster and does not require package installation. Use the magrittr pipe if you prefer it.</p>
<section id="step-4.1-clean-the-data" class="level3">
<h3 class="anchored" data-anchor-id="step-4.1-clean-the-data">Step 4.1 Clean the data</h3>
<section id="task-a-clean-your-column-names-and-select-columns-for-analysis" class="level4">
<h4 class="anchored" data-anchor-id="task-a-clean-your-column-names-and-select-columns-for-analysis"><strong>Task A: Clean your column names and select columns for analysis</strong></h4>
<p>Due to quality and data storage issues, your team recommends that you create a clean linelist that only contains information on the unique identifier, location of the case, disease, and the date the notification was reported to the surveillance system.</p>
<p><strong>Write R code to produce a new clean data frame called <code>data_notif</code></strong>, applying the following cleaning tasks:</p>
<ul>
<li>Rename columns to be more machine readable (remove spaces and capitalization) using <code>clean_names()</code> from the {janitor} package</li>
<li>Use the <code>rename()</code> function from <code>{dplyr}</code> so that the column with the date the case was reported is changed to a more concise <code>date_report</code>.<br>
</li>
<li>Select relevant columns for analysis with the <code>select()</code> function from the <code>{dplyr}</code> package.</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to read a hint
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Start your code with the name of the new data frame, the assignment arrow, and the name of the raw data object. This shows that the outcome of the raw data processing will be assigned to a new object called <code>data_notif</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>data_notif <span class="ot">&lt;-</span> data_notif_raw</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then build on this code by adding in additional functions, chained together with a pipe. This lets you perform several operations in one smooth sequence. First, you’ll use <code>clean_names()</code> to standardize all your column names. It automatically replaces spaces and special characters with underscores and converts everything to lowercase, making names easier to work with. Then, you can use <code>rename()</code> to give a column a new name. Just remember, when you use <code>rename()</code>, the column will already have its <code>clean_names()</code> version.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>data_notif <span class="ot">&lt;-</span> data_notif_raw <span class="sc">|&gt;</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">NEW_NAME =</span> OLD_NAME) <span class="sc">|&gt;</span> </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(VAR_NAMES)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the solution (try it yourself first!)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Here is the code to clean column names and select the right columns for analysis:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean data</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>data_notif <span class="ot">&lt;-</span> data_notif_raw <span class="sc">|&gt;</span> </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">date_report =</span> date_reported_by_health_facility_community) <span class="sc">|&gt;</span> </span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(notification_id, residential_district, disease_notified, date_report)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="task-b-standardize-categorical-values" class="level4">
<h4 class="anchored" data-anchor-id="task-b-standardize-categorical-values"><strong>Task B: Standardize categorical values</strong></h4>
<p>You already know from your data inspection that the values for district are not standardized.</p>
<p><strong>Add a <code>mutate()</code> function to clean the <code>residential_district</code> column</strong>, to:</p>
<ul>
<li>Standardize the capitalization of the column</li>
<li>Replace the existing <code>residential_district</code> column with a clean column that only contains these district values: “Lake Minara”, “Feveria Central”, and “Kasara”.</li>
</ul>
<p>See the hint to see what functions you can use.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to read a hint
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Try using <code>str_to_title()</code> from <code>{stringr}</code> package so that the first letter of each word is upper case and all other letters are lower case. You can also use <code>case_match()</code> to specify different specific typos.</p>
<p>Use the ‘help’ functionality of RStudio to see how to use these functions. For example, type <code>?case_match</code> in your console to get the help page. <strong>NOTE</strong> on <code>case_match()</code> - this is a very useful function for replacing or correcting values, and supersedes <code>recode()</code>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the solution (try it yourself first!)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Your cleaning code should now look like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean data</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>data_notif <span class="ot">&lt;-</span> data_notif_raw <span class="sc">|&gt;</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">date_report =</span> date_reported_by_health_facility_community) <span class="sc">|&gt;</span> </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(notification_id, residential_district, disease_notified, date_report) <span class="sc">|&gt;</span> </span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">residential_district =</span> <span class="fu">str_to_title</span>(residential_district)) <span class="sc">|&gt;</span> </span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">residential_district =</span> <span class="fu">case_match</span>(residential_district,</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">c</span>(<span class="st">"F Central"</span>, <span class="st">"Feveria C"</span>, <span class="st">"Feveria Central"</span>) <span class="sc">~</span> <span class="st">"Feveria Central"</span>,</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">c</span>(<span class="st">"Kasara"</span>, <span class="st">"Ksr"</span>) <span class="sc">~</span> <span class="st">"Kasara"</span>,</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">c</span>(<span class="st">"L Minara"</span>, <span class="st">"Lake Minara"</span>, <span class="st">"Lakeside"</span>) <span class="sc">~</span> <span class="st">"Lake Minara"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You could also wrap the <code>str_to_title</code> function into the <code>case_match()</code> for shorter code, as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean data</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>data_notif <span class="ot">&lt;-</span> data_notif_raw <span class="sc">|&gt;</span> </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">date_report =</span> date_reported_by_health_facility_community) <span class="sc">|&gt;</span> </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(notification_id, residential_district, disease_notified, date_report) <span class="sc">|&gt;</span> </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">residential_district =</span> <span class="fu">case_match</span>(<span class="fu">str_to_title</span>(residential_district),</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">c</span>(<span class="st">"F Central"</span>, <span class="st">"Feveria C"</span>, <span class="st">"Feveria Central"</span>) <span class="sc">~</span> <span class="st">"Feveria Central"</span>,</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">c</span>(<span class="st">"Kasara"</span>, <span class="st">"Ksr"</span>) <span class="sc">~</span> <span class="st">"Kasara"</span>,</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">c</span>(<span class="st">"L Minara"</span>, <span class="st">"Lake Minara"</span>, <span class="st">"Lakeside"</span>) <span class="sc">~</span> <span class="st">"Lake Minara"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="task-c-manage-dates" class="level4">
<h4 class="anchored" data-anchor-id="task-c-manage-dates"><strong>Task C: Manage dates</strong></h4>
<p>The column for report date needs to be transformed so that it is recognized as a date in R. This will allow you to analyse trends over time, including over weeks and months.</p>
<p><strong>Review the values within the <code>date_report</code> column. Then, add a line to your cleaning code to change <code>date_report</code> into a date class.</strong></p>
<p>Knowing the structure will allow you to use the correct function to convert the column into a date class. We recommend you use one of the functions from the <code>{lubridate}</code> package: either <code>ymd()</code> (for converting dates written as year-month-date), <code>mdy()</code> (for dates written as month-day-year), or <code>dmy()</code> (for dates written as day-month-year). These functions will recognize any way of writing the date as long as it is the correct order, for example “21st August 2025” and “21-08-2024” would both be recognized by <code>dmy()</code>.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Questions
</div>
</div>
<div class="callout-body-container callout-body">
<div class="webex-check">
How are the dates currently formatted?
<div id="radio_OLXAGZYPBZ" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_OLXAGZYPBZ" value=""> <span>day-month-year</span></label><label><input type="radio" autocomplete="off" name="radio_OLXAGZYPBZ" value="answer"> <span>year-month-day</span></label><label><input type="radio" autocomplete="off" name="radio_OLXAGZYPBZ" value=""> <span>month-day-year</span></label><label><input type="radio" autocomplete="off" name="radio_OLXAGZYPBZ" value=""> <span>year-day-month</span></label>
</div>
Which <code>mutate()</code> function should you use to convert the date_report column into a date class?
<div id="radio_ULXVAGJNPE" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_ULXVAGJNPE" value="answer"> <span>mutate(date_report = ymd(date_report))</span></label><label><input type="radio" autocomplete="off" name="radio_ULXVAGJNPE" value=""> <span>mutate(date_report = dmy(date_report))</span></label><label><input type="radio" autocomplete="off" name="radio_ULXVAGJNPE" value=""> <span>mutate(date_report = mdy(date_report))</span></label>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the solution (try it yourself first!)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>You can use the <code>head()</code> function to view the first six rows of data for the <code>date_report</code> column. You can see that they are written with the year first, then the month, then the date.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_notif<span class="sc">$</span>date_report)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2024-03-08" "2024-03-11" "2024-03-11" "2024-03-18" "2024-03-14"
[6] "2024-03-12"</code></pre>
</div>
</div>
<p>You can use the <code>ymd()</code> function inside <code>mutate()</code> to convert the class of the <code>date_report</code> function. You can double-check that the class is correct by running a <code>class()</code> function afterwards.</p>
<p>Your cleaning code should now look like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean data</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>data_notif <span class="ot">&lt;-</span> data_notif_raw <span class="sc">|&gt;</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">date_report =</span> date_reported_by_health_facility_community) <span class="sc">|&gt;</span> </span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(notification_id, residential_district, disease_notified, date_report) <span class="sc">|&gt;</span> </span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">residential_district =</span> <span class="fu">case_match</span>(<span class="fu">str_to_title</span>(residential_district),</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">c</span>(<span class="st">"F Central"</span>, <span class="st">"Feveria C"</span>, <span class="st">"Feveria Central"</span>) <span class="sc">~</span> <span class="st">"Feveria Central"</span>,</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">c</span>(<span class="st">"Kasara"</span>, <span class="st">"Ksr"</span>) <span class="sc">~</span> <span class="st">"Kasara"</span>,</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">c</span>(<span class="st">"L Minara"</span>, <span class="st">"Lake Minara"</span>, <span class="st">"Lakeside"</span>) <span class="sc">~</span> <span class="st">"Lake Minara"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date_report =</span> <span class="fu">ymd</span>(date_report)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And you can double check the class with this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(data_notif<span class="sc">$</span>date_report)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Date"</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="task-d-check-for-duplicates" class="level4">
<h4 class="anchored" data-anchor-id="task-d-check-for-duplicates"><strong>Task D: Check for duplicates</strong></h4>
<p>Your colleagues tell you that each <code>notification_id</code> represents one suspected case. You now want to <strong>create a table to check if <code>notification_id</code> is duplicated across rows in you data</strong>.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Questions
</div>
</div>
<div class="callout-body-container callout-body">
<div class="webex-check">
Does one row in the notification data equate to one case?
<div id="radio_ALXIOGDMWZ" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_ALXIOGDMWZ" value="answer"> <span>Yes</span></label><label><input type="radio" autocomplete="off" name="radio_ALXIOGDMWZ" value=""> <span>No</span></label>
</div>
Do you need to deduplicate your data for epidemiological analysis of cases?
<div id="radio_MZMEXEZFMR" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_MZMEXEZFMR" value=""> <span>Yes</span></label><label><input type="radio" autocomplete="off" name="radio_MZMEXEZFMR" value="answer"> <span>No</span></label>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-23-contents" aria-controls="callout-23" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to read a hint
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-23" class="callout-23-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>There are many ways to do this, but try using <code>count()</code> function from <code>{dplyr}</code>. It will create a table that counts the number of rows per unique value of the column that you specify inside the function. Then, use <code>tabyl()</code> to look at the distribution of these counts.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-24-contents" aria-controls="callout-24" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the solution (try it yourself first!)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-24" class="callout-24-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>First, pipe from the notification data into the <code>count()</code> function, giving the <code>notification_id</code> column as the only argument. This creates a table that counts the number of rows per unique value of <code>notification_id</code>, shown in a new column <code>n</code>. You can see for example in this excerpt that there is only one row per each of these 6 <code>notification_id</code>s.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>data_notif <span class="sc">|&gt;</span> </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(notification_id) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  notification_id n
1          00399b 1
2          005c85 1
3          006f52 1
4          00cbbb 1
5          01830d 1
6          019045 1</code></pre>
</div>
</div>
<p>Then tabulate the new column <code>n</code> with the <code>tabyl()</code>, which shows that there is only one row per unique <code>notification_id</code>. This means that one row equates to one case, and no further deduplication is needed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>data_notif <span class="sc">|&gt;</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(notification_id) <span class="sc">|&gt;</span> </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> n n_n percent
 1 987       1</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="step-4.2-simple-descriptive-analysis" class="level3">
<h3 class="anchored" data-anchor-id="step-4.2-simple-descriptive-analysis">Step 4.2 Simple descriptive analysis</h3>
<p>You can now comfortably proceed with descriptive analyses of cases, as your data is clean and you know that one row equals one case. Use the <code>tabyl()</code> function for the following tasks.</p>
<section id="task-a-count-the-number-of-suspected-cases-of-each-disease-diagnosed-in-feveria-in-2024" class="level4">
<h4 class="anchored" data-anchor-id="task-a-count-the-number-of-suspected-cases-of-each-disease-diagnosed-in-feveria-in-2024"><strong>Task A: Count the number of suspected cases of each disease diagnosed in Feveria in 2024</strong></h4>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Questions
</div>
</div>
<div class="callout-body-container callout-body">
<div class="webex-check">
Which disease was most commonly diagnosed by clinics in Feveria in 2024?
<div id="radio_XEPFLINWUZ" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_XEPFLINWUZ" value=""> <span>Cholera</span></label><label><input type="radio" autocomplete="off" name="radio_XEPFLINWUZ" value="answer"> <span>Malaria</span></label><label><input type="radio" autocomplete="off" name="radio_XEPFLINWUZ" value=""> <span>Dengue</span></label><label><input type="radio" autocomplete="off" name="radio_XEPFLINWUZ" value=""> <span>Typhoid Fever</span></label><label><input type="radio" autocomplete="off" name="radio_XEPFLINWUZ" value=""> <span>Yellow Fever</span></label>
</div>
Which disease was least commonly diagnosed by clinics in Feveria in 2024?
<div id="radio_RHIPIVMAGK" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_RHIPIVMAGK" value=""> <span>Cholera</span></label><label><input type="radio" autocomplete="off" name="radio_RHIPIVMAGK" value=""> <span>Malaria</span></label><label><input type="radio" autocomplete="off" name="radio_RHIPIVMAGK" value=""> <span>Dengue</span></label><label><input type="radio" autocomplete="off" name="radio_RHIPIVMAGK" value="answer"> <span>Typhoid Fever</span></label><label><input type="radio" autocomplete="off" name="radio_RHIPIVMAGK" value=""> <span>Yellow Fever</span></label>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-26-contents" aria-controls="callout-26" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the solution (try it yourself first!)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-26" class="callout-26-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Using <code>tabyl()</code>, we can see that there were 533 suspected cases of malaria in Feveria in 2024, and only 35 suspected cases of typhoid fever.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(data_notif, disease_notified)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> disease_notified   n    percent
          cholera  46 0.04660588
           dengue 273 0.27659574
          malaria 533 0.54002026
          typhoid  35 0.03546099
     yellow fever 100 0.10131712</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="task-b-count-the-number-of-suspected-cases-by-disease-and-district-of-residence" class="level4">
<h4 class="anchored" data-anchor-id="task-b-count-the-number-of-suspected-cases-by-disease-and-district-of-residence"><strong>Task B: Count the number of suspected cases by disease and district of residence</strong></h4>
<p><strong>Use <code>tabyl()</code> to cross-tabulate the disease and district of residence columns.</strong></p>
<p>Build on your table by adding various <code>adorn</code> functions from the <code>{janitor}</code> package, to see percentage distributions, e.g. <code>adorn_percentages()</code>, <code>adorn_pct_formatting()</code>, and <code>adorn_ns()</code></p>
<p>Type the name of the function after a ? in your console (e.g. <code>?adorn_ns</code>) to see the relevant Help pages. You can also look at the <a href="https://epirhandbook.com/en/new_pages/tables_descriptive.html#tbl_janitor">section about {janitor} in the Epi R Handbook</a> for more explanation of <code>adorn_xxx()</code> functions.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Questions
</div>
</div>
<div class="callout-body-container callout-body">
<div class="webex-check">
Which district reported the most vector-borne disease in 2024 (malaria, dengue, yellow fever)?
<div id="radio_QIWAITFFVS" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_QIWAITFFVS" value="answer"> <span>Lake Minara</span></label><label><input type="radio" autocomplete="off" name="radio_QIWAITFFVS" value=""> <span>Feveria Central</span></label><label><input type="radio" autocomplete="off" name="radio_QIWAITFFVS" value=""> <span>Kasara</span></label>
</div>
Which district reported the most diarrhoeal disease in 2024 (cholera, typhoid fever)?
<div id="radio_QOGXAKVEQT" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_QOGXAKVEQT" value=""> <span>Lake Minara</span></label><label><input type="radio" autocomplete="off" name="radio_QOGXAKVEQT" value="answer"> <span>Feveria Central</span></label><label><input type="radio" autocomplete="off" name="radio_QOGXAKVEQT" value=""> <span>Kasara</span></label>
</div>
What factors contribute to increased diarrhoeal disease in this specific district (selected in previous question)?
<div id="radio_ILBUQFTINE" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_ILBUQFTINE" value="answer"> <span>Unreliable water and sanitation infrastructure</span></label><label><input type="radio" autocomplete="off" name="radio_ILBUQFTINE" value=""> <span>Overcrowding of mosquitoes</span></label><label><input type="radio" autocomplete="off" name="radio_ILBUQFTINE" value=""> <span>We don't know</span></label>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-28-contents" aria-controls="callout-28" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to read a hint
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-28" class="callout-28-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Here is some code to get you started. It cross-tabulates <code>disease_notified</code> and <code>residential_district</code> with <code>tabyl()</code>, then adding <code>adorn_percentages()</code> converts these numbers to percentages with many decimals. You then need to pipe into <code>adorn_pct_formatting()</code> to convert into actual percentage formatting, and then <code>adorn_ns()</code> to add numbers back in in parentheses.</p>
<p>Note that <code>adorn_xxx()</code> functions need to be applied in a specific order!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(data_notif, disease_notified, residential_district) <span class="sc">|&gt;</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_percentages</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For factors contributing to more diarrhea - scroll up to earlier in the case study when the districts were first introduced!</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-29-contents" aria-controls="callout-29" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the solution (try it yourself first!)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-29" class="callout-29-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Using <code>tabyl()</code>, we can see that most suspected cases of dengue, malaria, and yellow fever were located in Lake Minara - the lake area with higher density of mosquitoes and therefore vector-borne disease. Meanwhile the majority of cholera and typhoid fever were in Feveria Central, the over-populated urban area with water and sanitation infrastructure issues that result in higher risk of flooding and drinking water contamination during rainy weather.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(data_notif, disease_notified, residential_district) <span class="sc">|&gt;</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_percentages</span>() <span class="sc">|&gt;</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_pct_formatting</span>() <span class="sc">|&gt;</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_ns</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> disease_notified Feveria Central      Kasara Lake Minara
          cholera      91.3% (42)  8.7%   (4)  0.0%   (0)
           dengue       9.5% (26) 17.6%  (48) 72.9% (199)
          malaria      13.7% (73) 19.9% (106) 66.4% (354)
          typhoid      68.6% (24) 31.4%  (11)  0.0%   (0)
     yellow fever      11.0% (11) 21.0%  (21) 68.0%  (68)</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="step-5.-clean-consolidate-and-describe-the-laboratory-data" class="level2">
<h2 class="anchored" data-anchor-id="step-5.-clean-consolidate-and-describe-the-laboratory-data">Step 5. Clean, consolidate, and describe the laboratory data</h2>
<p>From your earlier work in step 3, you have found that the laboratory data contains only testing data, and no patient information. The data is already very clean, so we only need to standardize one column. We will also want to process the laboratory data frame to be one row per notification, so that it can be neatly linked to the notification data frame.</p>
<section id="step-5.1-standardise-the-test-results" class="level3">
<h3 class="anchored" data-anchor-id="step-5.1-standardise-the-test-results">Step 5.1 Standardise the test results</h3>
<section id="task-a-convert-any-value-with-p-to-positive-n-to-negative-and-i-to-indeterminate." class="level4">
<h4 class="anchored" data-anchor-id="task-a-convert-any-value-with-p-to-positive-n-to-negative-and-i-to-indeterminate."><strong>Task A: Convert any value with “P” to “Positive”, “N” to “Negative”, and “I” to “Indeterminate.</strong></h4>
<p>Create a new object <code>data_lab</code>. This will allow a more straight-forward analysis and interpretation of results.</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-30-contents" aria-controls="callout-30" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the solution (try it yourself first!)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-30" class="callout-30-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Use <code>case_match()</code> to turn the different original values into “Positive”, “Negative”, or “Indeterminate”:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>data_lab <span class="ot">&lt;-</span> data_lab_raw <span class="sc">|&gt;</span> </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">case_match</span>(value, </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">c</span>(<span class="st">"P"</span>, <span class="st">"PO1"</span>, <span class="st">"PO139"</span>) <span class="sc">~</span> <span class="st">"Positive"</span>,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"N"</span> <span class="sc">~</span> <span class="st">"Negative"</span>,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"I"</span> <span class="sc">~</span> <span class="st">"Indeterminate"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can then double-check that the new values look correct by tabulating and comparing the values in the original data frame and the clean one. Make sure that you used the letter ‘O’ and not the number ‘0’!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(data_lab_raw, value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> value   n    percent
     I  73 0.05555556
     N 682 0.51902588
     P 521 0.39649924
   PO1  22 0.01674277
 PO139  16 0.01217656</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(data_lab, value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         value   n    percent
 Indeterminate  73 0.05555556
      Negative 682 0.51902588
      Positive 559 0.42541857</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="step-5.2-consolidate-to-one-row-per-test" class="level3">
<h3 class="anchored" data-anchor-id="step-5.2-consolidate-to-one-row-per-test">Step 5.2 Consolidate to one row per test</h3>
<section id="task-a-review-the-number-of-samples-with-multiple-rows" class="level4">
<h4 class="anchored" data-anchor-id="task-a-review-the-number-of-samples-with-multiple-rows"><strong>Task A: Review the number of samples with multiple rows</strong></h4>
<p>We already know that some samples have multiple rows, and that this is because the dengue assay has three targets, with one row per target result.</p>
<p>Now <strong>find the number of samples with multiple rows</strong>.</p>
<p>Do this as you did with the notification data, using the <code>data_lab</code> object: first count the number of rows per sample, then create a table to show the distribution of row numbers. Keep in mind that each sample is identified by a <code>sample_ID</code>.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Questions
</div>
</div>
<div class="callout-body-container callout-body">
<div class="webex-check">
How many samples (unique <code>sample_id</code>s) are repeated across three rows?
<div id="radio_NRABXOZXCK" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_NRABXOZXCK" value=""> <span>200</span></label><label><input type="radio" autocomplete="off" name="radio_NRABXOZXCK" value="answer"> <span>215</span></label><label><input type="radio" autocomplete="off" name="radio_NRABXOZXCK" value=""> <span>230</span></label>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-32-contents" aria-controls="callout-32" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the solution (try it yourself first!)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-32" class="callout-32-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>First, pipe from the lab data into the <code>count()</code> function, giving the <code>sample_id</code> column as the only argument. This creates a table that counts the number of rows per unique value of <code>sample_id</code>, shown in a new column <code>n</code>. You can see for example that the <code>sample_id</code> “000e8eee” has three rows, whereas the <code>sample_id</code> “001e1878” is only seen on one row.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>data_lab <span class="sc">|&gt;</span> </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sample_id) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  sample_id n
1  000e8eee 3
2  001e1878 1
3  005f39af 1
4  00b30781 3
5  00b56d18 1
6  0110abcd 3</code></pre>
</div>
</div>
<p>Then tabulate the new column <code>n</code> with the <code>tabyl()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>data_lab <span class="sc">|&gt;</span> </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sample_id) <span class="sc">|&gt;</span> </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> n n_n   percent
 1 669 0.7567873
 3 215 0.2432127</code></pre>
</div>
</div>
<p>You can even double-check that this only applies to the dengue assay by adding in the <code>test</code> column to the calculation. You can see that it is only the dengue test that has 3 rows per sample.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>data_lab <span class="sc">|&gt;</span> </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(test, sample_id) <span class="sc">|&gt;</span> </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(test, n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   test   1   3
          Blood culture  33   0
     Dengue NS1/IgG/IgM   0 215
              IgM ELISA  88   0
          Stool Culture  45   0
 Whole Blood Microscopy 503   0</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="task-b-consolidate-to-one-row-per-sample_id-prioritizing-positive-results" class="level4">
<h4 class="anchored" data-anchor-id="task-b-consolidate-to-one-row-per-sample_id-prioritizing-positive-results"><strong>Task B: Consolidate to one row per <code>sample_id</code>, prioritizing positive results</strong></h4>
<p>As you saw in section 3.2, your dengue test provides results for three different targets: IgG, IgM, and NS.1. The results for each of these targets can be either negative or positive. However, to simplify and consolidate your data, you want to assign a single negative or positive label to each sample, to indicate if the sample represents current infection.</p>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-fa93e48e{}.cl-fa852322{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fa8b24d4{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fa8b24e8{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fa8b6a2a{width:1.202in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fa8b6a3e{width:0.888in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fa8b6a48{width:0.82in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fa8b6a49{width:1.202in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fa8b6a52{width:0.888in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fa8b6a5c{width:0.82in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fa8b6a5d{width:1.202in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fa8b6a66{width:0.888in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fa8b6a70{width:0.82in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fa8b6a71{width:1.202in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fa8b6a7a{width:0.888in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fa8b6a7b{width:0.82in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-fa93e48e"><thead><tr style="overflow-wrap:break-word;"><th class="cl-fa8b6a2a"><p class="cl-fa8b24d4"><span class="cl-fa852322">target</span></p></th><th class="cl-fa8b6a3e"><p class="cl-fa8b24e8"><span class="cl-fa852322">Negative</span></p></th><th class="cl-fa8b6a48"><p class="cl-fa8b24e8"><span class="cl-fa852322">Positive</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-fa8b6a49"><p class="cl-fa8b24d4"><span class="cl-fa852322">Dengue IgG</span></p></td><td class="cl-fa8b6a52"><p class="cl-fa8b24e8"><span class="cl-fa852322">110</span></p></td><td class="cl-fa8b6a5c"><p class="cl-fa8b24e8"><span class="cl-fa852322">105</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fa8b6a5d"><p class="cl-fa8b24d4"><span class="cl-fa852322">Dengue IgM</span></p></td><td class="cl-fa8b6a66"><p class="cl-fa8b24e8"><span class="cl-fa852322">105</span></p></td><td class="cl-fa8b6a70"><p class="cl-fa8b24e8"><span class="cl-fa852322">110</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fa8b6a71"><p class="cl-fa8b24d4"><span class="cl-fa852322">Dengue NS.1</span></p></td><td class="cl-fa8b6a7a"><p class="cl-fa8b24e8"><span class="cl-fa852322">139</span></p></td><td class="cl-fa8b6a7b"><p class="cl-fa8b24e8"><span class="cl-fa852322">76</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>Your colleague Ben, who works in the lab, advises you on the cleaning as follows:</p>
<ul>
<li>A sample can be considered positive if NS.1 or IgM are positive (as both can represent acute infection)</li>
<li>You can ignore IgG (because a positive result in the absence of positive NS.1 or IgM is indicative of immunity after a past resolved infection)</li>
</ul>
<p>Now you need to <strong>consolidate the dengue test results to one row per test, with one result value</strong>. Use <code>filter()</code>, <code>arrange()</code>, and <code>slice()</code>, making sure any sample positive for NS.1 or IgM is considered positive for dengue. Create a new object called <code>data_lab_tests</code></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-33-contents" aria-controls="callout-33" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to read a hint
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-33" class="callout-33-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Try to apply the following to consolidate according to Ben’s recommendation:</p>
<ol type="1">
<li>Remove IgG Results: filter out rows where the target is “IgG” using <code>filter()</code> from <code>{dplyr}</code>.</li>
<li>Prioritize positive IgM/NS1results: Group by <code>sample_id</code> and arrange rows with <code>arrange()</code> so any ‘P’ (positive) result appears first</li>
<li>Filter to final status: Keep only the first row using <code>slice(1)</code> to get the positive or negative result for the sample.</li>
</ol>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-34-contents" aria-controls="callout-34" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the solution (try it yourself first!)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-34" class="callout-34-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Here is the code to filter out the dengue IgG results, and then consolidate the test result within each group of rows with the same <code>sample_id</code>, prioritizing positive results.</p>
<p>You need to specify <code>desc</code> within <code>arrange()</code>, as this means that the results will be in reverse alphabetical order, meaning P will be at the top.</p>
<p>Also, add the <code>ungroup()</code> function at the end so that the new data is not grouped, which could confuse further analyses.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>data_lab_tests <span class="ot">&lt;-</span> data_lab <span class="sc">|&gt;</span> </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(target <span class="sc">!=</span> <span class="st">"Dengue IgG"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sample_id) <span class="sc">|&gt;</span> </span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(value)) <span class="sc">|&gt;</span> </span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can then double-check that the new object <code>data_lab_tests</code> has only one row per test, using the combination of <code>count()</code> and <code>tabyl()</code> like you did in Task A.</p>
<p>This table shows you that all unique sample IDs are only present in one row each:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>data_lab_tests <span class="sc">|&gt;</span> </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sample_id) <span class="sc">|&gt;</span> </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> n n_n percent
 1 884       1</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="task-c-deduplicate-to-one-row-per-notification_id-prioritizing-positive-results" class="level4">
<h4 class="anchored" data-anchor-id="task-c-deduplicate-to-one-row-per-notification_id-prioritizing-positive-results"><strong>Task C: Deduplicate to one row per <code>notification_id</code>, prioritizing positive results</strong></h4>
<p>Next, you check the number of tests per notification ID in your new consolidated data.</p>
<p>You can see that there are 26 rows with the same <code>notification_id</code> as another row, but only among cases tested with whole blood microscopy for malaria.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>data_lab_tests <span class="sc">|&gt;</span> </span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(test, notification_id) <span class="sc">|&gt;</span> </span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(test, n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   test   1  2
          Blood culture  33  0
     Dengue NS1/IgG/IgM 215  0
              IgM ELISA  88  0
          Stool Culture  45  0
 Whole Blood Microscopy 451 26</code></pre>
</div>
</div>
<p>You investigate further, looking at one example case with <code>notification_id</code> “043228”. This shows you that this one case was tested twice, with two different samples, one week apart. The first result was positive, and the second result was negative.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>data_lab_tests <span class="sc">|&gt;</span> </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(notification_id <span class="sc">==</span> <span class="st">"043228"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 7
  laboratory_name        notification_id sample_id date_test  test  target value
  &lt;chr&gt;                  &lt;chr&gt;           &lt;chr&gt;     &lt;IDate&gt;    &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;
1 Kasara University Hos… 043228          27c37cd8  2024-06-18 Whol… Plasm… Posi…
2 Kasara University Hos… 043228          d2271be0  2024-06-25 Whol… Plasm… Nega…</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Questions
</div>
</div>
<div class="callout-body-container callout-body">
<div class="webex-check">
Which statement about the lab data is correct?
<div id="radio_FICKTZZRPR" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_FICKTZZRPR" value=""> <span>All cases of different diseases get retested</span></label><label><input type="radio" autocomplete="off" name="radio_FICKTZZRPR" value="answer"> <span>Some malaria cases get retested</span></label><label><input type="radio" autocomplete="off" name="radio_FICKTZZRPR" value=""> <span>All malaria cases get retested</span></label>
</div>
Will you need to deduplicate the lab data, to link with the notification data?
<div id="radio_YVFCCZHVWY" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_YVFCCZHVWY" value="answer"> <span>Yes - we need one row representing the lab result per notification</span></label><label><input type="radio" autocomplete="off" name="radio_YVFCCZHVWY" value=""> <span>No - the data is sufficiently deduplicated</span></label>
</div>
</div>
</div>
</div>
<p>If you answered that you need to deduplicate, you are correct!</p>
<p><strong>Deduplicate your data to have one row per <code>notification ID</code></strong>, prioritizing positive results, so that you can link to the notification data.</p>
<p>To do this, follow a similar process as you did in Task B, using the data frame produced by task B:</p>
<ul>
<li>Group by <code>notification_id</code></li>
<li>Arrange by the test result value so that values starting with P are prioritized in the top row, followed by N (negative), and then I (indeterminate).</li>
<li>Then keep the first row within each group of <code>notification_id</code>s, using <code>slice()</code>.</li>
<li>When doing this, create a new object called <code>data_lab_cases</code>.</li>
</ul>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-36-contents" aria-controls="callout-36" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the solution (try it yourself first!)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-36" class="callout-36-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Here is the code to deduplicate rows within each group of rows with the same <code>notification_id</code>, prioritizing positive results. Once again you need to specify <code>desc</code> within <code>arrange()</code>. This works perfectly because the desired priority order for results — positive, then negative, then indeterminate — happens to align with reverse alphabetical order (P comes before N, which comes before I, when sorted descending).</p>
<p>If your priority order was more complex or didn’t match alphabetical sorting (e.g., if “indeterminate” needed to come before “negative”), you’d have to convert the result column into a factor and explicitly define the desired order of its levels. Don’t forget to ungroup again at the end.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>data_lab_cases <span class="ot">&lt;-</span> data_lab_tests <span class="sc">|&gt;</span> </span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(notification_id) <span class="sc">|&gt;</span> </span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(value)) <span class="sc">|&gt;</span> </span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can then double-check that the new object <code>data_lab_cases</code> has only one row per test, using the combination of <code>count()</code> and <code>tabyl()</code> like you did in Task A. This table shows you that all unique sample IDs are only present in one row each:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>data_lab_cases <span class="sc">|&gt;</span> </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(notification_id) <span class="sc">|&gt;</span> </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> n n_n percent
 1 858       1</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="step-5.3-simple-descriptive-analysis" class="level3">
<h3 class="anchored" data-anchor-id="step-5.3-simple-descriptive-analysis">Step 5.3 Simple descriptive analysis</h3>
<p>Now we have two objects that we can use for analysis of laboratory data: <code>data_lab_tests</code> and <code>data_lab_cases</code>.</p>
<section id="task-a-count-the-number-of-disease-specific-tests-positive-results-and-negative-results-in-the-2024-laboratory-data" class="level4">
<h4 class="anchored" data-anchor-id="task-a-count-the-number-of-disease-specific-tests-positive-results-and-negative-results-in-the-2024-laboratory-data"><strong>Task A: Count the number of disease-specific tests, positive results, and negative results in the 2024 laboratory data</strong></h4>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Questions
</div>
</div>
<div class="callout-body-container callout-body">
<div class="webex-check">
Which object should you use to analyse tests?
<div id="radio_MJQQXJDNAH" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_MJQQXJDNAH" value="answer"> <span>data_lab_tests</span></label><label><input type="radio" autocomplete="off" name="radio_MJQQXJDNAH" value=""> <span>data_lab_cases</span></label><label><input type="radio" autocomplete="off" name="radio_MJQQXJDNAH" value=""> <span>neither</span></label>
</div>
How many tests were conducted to test for malaria (via whole blood microscopy)?
<div id="radio_YSXQBLDMDE" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_YSXQBLDMDE" value=""> <span>215</span></label><label><input type="radio" autocomplete="off" name="radio_YSXQBLDMDE" value="answer"> <span>503</span></label><label><input type="radio" autocomplete="off" name="radio_YSXQBLDMDE" value=""> <span>88</span></label><label><input type="radio" autocomplete="off" name="radio_YSXQBLDMDE" value=""> <span>190</span></label>
</div>
What percentage of tests for cholera (via stool culture) were positive?
<div id="radio_EHYTAHPMLL" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_EHYTAHPMLL" value=""> <span>21%</span></label><label><input type="radio" autocomplete="off" name="radio_EHYTAHPMLL" value=""> <span>11%</span></label><label><input type="radio" autocomplete="off" name="radio_EHYTAHPMLL" value="answer"> <span>84%</span></label><label><input type="radio" autocomplete="off" name="radio_EHYTAHPMLL" value=""> <span>87%</span></label>
</div>
Which test had the highest percentage of indeterminate results?
<div id="radio_TOQXUTLNKI" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_TOQXUTLNKI" value="answer"> <span>IgM ELISA (for yellow fever detection)</span></label><label><input type="radio" autocomplete="off" name="radio_TOQXUTLNKI" value=""> <span>Stool Culture (for cholera detection)</span></label><label><input type="radio" autocomplete="off" name="radio_TOQXUTLNKI" value=""> <span>Blood culture (for typhoid fever detection)</span></label>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-38-contents" aria-controls="callout-38" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the solution (try it yourself first!)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-38" class="callout-38-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Using <code>tabyl()</code>, we can see the number of positive, negative, and indeterminate results per test. You can add a series of <code>adorn()</code> functions to show percentages and totals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(data_lab_tests, test, value) <span class="sc">|&gt;</span> </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(<span class="at">where =</span> <span class="st">"col"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_percentages</span>() <span class="sc">|&gt;</span> </span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_pct_formatting</span>() <span class="sc">|&gt;</span> </span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_ns</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   test Indeterminate    Negative    Positive        Total
          Blood culture     6.1%  (2) 72.7%  (24) 21.2%   (7) 100.0%  (33)
     Dengue NS1/IgG/IgM     0.0%  (0) 13.5%  (29) 86.5% (186) 100.0% (215)
              IgM ELISA    11.4% (10) 51.1%  (45) 37.5%  (33) 100.0%  (88)
          Stool Culture    11.1%  (5)  4.4%   (2) 84.4%  (38) 100.0%  (45)
 Whole Blood Microscopy    11.1% (56) 51.1% (257) 37.8% (190) 100.0% (503)</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="task-b-count-the-number-of-suspected-cases-tested-in-the-2024-data" class="level4">
<h4 class="anchored" data-anchor-id="task-b-count-the-number-of-suspected-cases-tested-in-the-2024-data"><strong>Task B: Count the number of suspected cases tested in the 2024 data</strong></h4>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Questions
</div>
</div>
<div class="callout-body-container callout-body">
<div class="webex-check">
Which lab data frame should you use to count the number of suspected cases tested?
<div id="radio_OQUFXCYRWZ" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_OQUFXCYRWZ" value=""> <span>data_lab_raw</span></label><label><input type="radio" autocomplete="off" name="radio_OQUFXCYRWZ" value="answer"> <span>data_lab_cases</span></label><label><input type="radio" autocomplete="off" name="radio_OQUFXCYRWZ" value=""> <span>data_lab_tests</span></label><label><input type="radio" autocomplete="off" name="radio_OQUFXCYRWZ" value=""> <span>data_lab</span></label>
</div>
How many suspected cases were tested in the 2024 lab data?
<div id="radio_ANMMPLFVDW" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_ANMMPLFVDW" value="answer"> <span>858</span></label><label><input type="radio" autocomplete="off" name="radio_ANMMPLFVDW" value=""> <span>1314</span></label><label><input type="radio" autocomplete="off" name="radio_ANMMPLFVDW" value=""> <span>884</span></label>
</div>
Are there more suspected cases in the notification data or the lab data?
<div id="radio_MUOECLWTEG" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_MUOECLWTEG" value="answer"> <span>Notification data</span></label><label><input type="radio" autocomplete="off" name="radio_MUOECLWTEG" value=""> <span>Lab data</span></label>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-40-contents" aria-controls="callout-40" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the solution (try it yourself first!)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-40" class="callout-40-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>You can simply look at the number of rows in the <code>data_lab_cases</code> data frame to see the number of suspected cases who were tested.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(data_lab_cases)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 858</code></pre>
</div>
</div>
<p>This is less than the number of suspected cases that were in the clean notifiable disease surveillance data (<code>data_notif</code>) - which suggests that not all suspected cases in 2024 were tested by the time this data was available.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(data_notif)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 987</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="step-6.-linkage-and-final-processing" class="level2">
<h2 class="anchored" data-anchor-id="step-6.-linkage-and-final-processing">Step 6. Linkage and final processing</h2>
<p>Now that both linelists are clean and have one row per suspected case, you can link them to enable the full analysis requested by your boss.</p>
<section id="step-6.1-link-the-notification-data-and-lab-data" class="level3">
<h3 class="anchored" data-anchor-id="step-6.1-link-the-notification-data-and-lab-data">Step 6.1 Link the notification data and lab data</h3>
<section id="task-a-conduct-the-linkage" class="level4">
<h4 class="anchored" data-anchor-id="task-a-conduct-the-linkage"><strong>Task A: Conduct the linkage</strong></h4>
<p>Create a new object called <code>data_linked</code>, using a <code>xxx_join()</code> function from <code>{dplyr}</code>. You want to keep all notifications, but add on test results where available for each suspected case.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Questions
</div>
</div>
<div class="callout-body-container callout-body">
<div class="webex-check">
Which function is the correct approach if you want to retain all rows from your notification data and bring in results from your lab data?
<div id="radio_XQQBCZAZIS" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_XQQBCZAZIS" value="answer"> <span>left_join(data_notif, data_lab_cases…</span></label><label><input type="radio" autocomplete="off" name="radio_XQQBCZAZIS" value=""> <span>full_join(data_notif, data_lab_cases…</span></label><label><input type="radio" autocomplete="off" name="radio_XQQBCZAZIS" value=""> <span>right_join(data_notif, data_lab_cases…</span></label>
</div>
What identifier should be used to link the two linelists?
<div id="radio_HYXTDQDEWN" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_HYXTDQDEWN" value=""> <span>sample_id</span></label><label><input type="radio" autocomplete="off" name="radio_HYXTDQDEWN" value="answer"> <span>notification_id</span></label><label><input type="radio" autocomplete="off" name="radio_HYXTDQDEWN" value=""> <span>sample_id and date of report</span></label><label><input type="radio" autocomplete="off" name="radio_HYXTDQDEWN" value=""> <span>notification_id and date of report</span></label>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-42-contents" aria-controls="callout-42" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the solution (try it yourself first!)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-42" class="callout-42-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Link the data using the <code>left_join()</code> function, with notification data as the main data frame on the left. This will keep all the rows from this data frame, and will just bring in the test results from the lab data specified on the “right” of the function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>data_linked <span class="ot">&lt;-</span> <span class="fu">left_join</span>(data_notif, data_lab_cases, </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">by =</span> <span class="st">"notification_id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You are linking on the <code>notification_id</code> column, which is present, complete, and clean in both linelists.</p>
<p><strong>Note</strong>: You are lucky to work with such a straight-forward example of linkage! Usually you would need to really clean and check the ID column, or link on other columns like name and date fo birth. In Feveria, clinic staff are <em>fantastic</em> at consistently allocating notification IDs to each patient, including on the sample forms sent to the lab, and then the lab staff are equally <em>brilliant</em> at recording the notification ID in their lab systems so that the results can be linked back to the case.</p>
</div>
</div>
</div>
</section>
<section id="task-b-check-the-linkage-worked-as-expected" class="level4">
<h4 class="anchored" data-anchor-id="task-b-check-the-linkage-worked-as-expected"><strong>Task B: Check the linkage worked as expected</strong></h4>
<p>Now check your data and review a few things.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Questions
</div>
</div>
<div class="callout-body-container callout-body">
<div class="webex-check">
How many rows are in your new <code>data_linked</code> data frame?
<div id="radio_WGIOIEQABO" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_WGIOIEQABO" value="answer"> <span>987</span></label><label><input type="radio" autocomplete="off" name="radio_WGIOIEQABO" value=""> <span>884</span></label><label><input type="radio" autocomplete="off" name="radio_WGIOIEQABO" value=""> <span>858</span></label>
</div>
How does this compare to your original notification data?
<div id="radio_GMEYCZGFUD" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_GMEYCZGFUD" value=""> <span>more rows than the original</span></label><label><input type="radio" autocomplete="off" name="radio_GMEYCZGFUD" value="answer"> <span>same number of rows</span></label><label><input type="radio" autocomplete="off" name="radio_GMEYCZGFUD" value=""> <span>fewer rows</span></label>
</div>
What term best describes the linkage you just did?
<div id="radio_EMMQCJQIXH" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_EMMQCJQIXH" value=""> <span>many-to-one</span></label><label><input type="radio" autocomplete="off" name="radio_EMMQCJQIXH" value="answer"> <span>one-to-one</span></label><label><input type="radio" autocomplete="off" name="radio_EMMQCJQIXH" value=""> <span>many-to-many</span></label>
</div>
How many lab results were NOT linked (hint: <code>use anti-join()</code>)?
<div id="radio_FPCNDNQUPB" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_FPCNDNQUPB" value=""> <span>30</span></label><label><input type="radio" autocomplete="off" name="radio_FPCNDNQUPB" value=""> <span>19</span></label><label><input type="radio" autocomplete="off" name="radio_FPCNDNQUPB" value="answer"> <span>0</span></label>
</div>
How fortunate are you that your linkage is so successful?
<div id="radio_NGQGOXTJES" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_NGQGOXTJES" value=""> <span>What? Isn't all linkage this simple??</span></label><label><input type="radio" autocomplete="off" name="radio_NGQGOXTJES" value="answer"> <span>Very! Usually some records don't match</span></label>
</div>
What are typical reasons that lab data doesn’t match to the notifiable diseases data?
<div id="radio_MMWMJMMNIR" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_MMWMJMMNIR" value=""> <span>There are typos in the columns used for linkage, so they are not recognised as matching</span></label><label><input type="radio" autocomplete="off" name="radio_MMWMJMMNIR" value=""> <span>The lab data may contain additional cases from other clinics or countries</span></label><label><input type="radio" autocomplete="off" name="radio_MMWMJMMNIR" value=""> <span>The lab data may include test samples</span></label><label><input type="radio" autocomplete="off" name="radio_MMWMJMMNIR" value=""> <span>Notifications may have been accidentally missed in the notification data even though the sample was tested in the lab</span></label><label><input type="radio" autocomplete="off" name="radio_MMWMJMMNIR" value="answer"> <span>All of the above</span></label>
</div>
How many suspected cases do not have a result?
<div id="radio_PSKXWNDQTO" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_PSKXWNDQTO" value=""> <span>83</span></label><label><input type="radio" autocomplete="off" name="radio_PSKXWNDQTO" value=""> <span>100</span></label><label><input type="radio" autocomplete="off" name="radio_PSKXWNDQTO" value="answer"> <span>129</span></label>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-44-contents" aria-controls="callout-44" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the solution (try it yourself first!)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-44" class="callout-44-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Check the number of rows in each data frame with the <code>nrow()</code> function, or by checking the object information in your environment. You can see that this was simply a one-to-one merge, because each row had a unique <code>notification_id</code>, so one row in the notification data linked directly to one row in the lab data.</p>
<p><strong>Number of rows in notification data</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(data_notif)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 987</code></pre>
</div>
</div>
<p><strong>Number of rows in linked data</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(data_linked)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 987</code></pre>
</div>
</div>
<p>To check if there were any lab result that were not linked to the notification data, you can use <code>anti_join()</code>. This time the <code>data_lab_cases</code> object is on the left, as the function assess how many rows from the left data frame were not found in the right data frame, matching by <code>notification_id</code>. Here you do not need to generate a new data frame, you can simply pipe into an <code>nrow()</code> to count the number of rows. The output is 0, which shows there were no unlinked results - amazing!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anti_join</span>(data_lab_cases, data_notif, </span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">by =</span> <span class="st">"notification_id"</span>) <span class="sc">|&gt;</span> <span class="fu">nrow</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>Finally, to check the number of notifications without a result, you can either conduct an <code>anti_join</code> in putting <code>data_notif</code> first:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anti_join</span>(data_notif, data_lab_cases, </span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">by =</span> <span class="st">"notification_id"</span>) <span class="sc">|&gt;</span> <span class="fu">nrow</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 129</code></pre>
</div>
</div>
<p>Or, you can simply tabulate the number of missing values in the <code>value</code> column in <code>data_linked</code> (as the <code>value</code> column comes from the lab data).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(<span class="fu">is.na</span>(data_linked<span class="sc">$</span>value)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> is.na(data_linked$value)   n   percent
                    FALSE 858 0.8693009
                     TRUE 129 0.1306991</code></pre>
</div>
</div>
<p>Both of these approaches show that 129 suspected cases do not have a lab test result.</p>
</div>
</div>
</div>
</section>
</section>
<section id="step-6.2-label-confirmed-discarded-and-suspected-cases" class="level3">
<h3 class="anchored" data-anchor-id="step-6.2-label-confirmed-discarded-and-suspected-cases">Step 6.2 Label confirmed, discarded, and suspected cases</h3>
<section id="task-a-create-a-final-case-category-column" class="level4">
<h4 class="anchored" data-anchor-id="task-a-create-a-final-case-category-column"><strong>Task A: Create a final “case category” column</strong></h4>
<p><strong>Use <code>mutate()</code> to create a new column <code>case_category</code></strong>, updating the label of suspected cases according to their lab result. The categories should be as follows:</p>
<ul>
<li>If the result was positive: Confirmed</li>
<li>If the result was negative: Discarded</li>
<li>If the result was indeterminate or missing: Suspected</li>
</ul>
<p>This means that all cases in the notification data are initially suspected when reported, and then remain suspected if there is no conclusive test result.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Questions
</div>
</div>
<div class="callout-body-container callout-body">
<div class="webex-check">
Which is the most appropriate function for creating this new column?
<div id="radio_JBVNUBGNQL" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_JBVNUBGNQL" value="answer"> <span>case_when()</span></label><label><input type="radio" autocomplete="off" name="radio_JBVNUBGNQL" value=""> <span>if_else()</span></label><label><input type="radio" autocomplete="off" name="radio_JBVNUBGNQL" value=""> <span>case_match()</span></label>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-46-contents" aria-controls="callout-46" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the solution (try it yourself first!)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-46" class="callout-46-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>You should use <code>case_when()</code> to create the new column. This function is ideal for applying multiple logical conditions to create multiple values, whereas <code>case_match()</code> is better for replacing specific values, and <code>if_else()</code> is better if there are only two possible values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>data_linked <span class="ot">&lt;-</span> data_linked <span class="sc">|&gt;</span> </span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">case_category =</span> <span class="fu">case_when</span>(value<span class="sc">==</span><span class="st">"Positive"</span> <span class="sc">~</span> <span class="st">"Confirmed"</span>,</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>                                   value<span class="sc">==</span><span class="st">"Negative"</span> <span class="sc">~</span> <span class="st">"Discarded"</span>,</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>                                   value<span class="sc">==</span><span class="st">"Indeterminate"</span> <span class="sc">|</span> <span class="fu">is.na</span>(value) <span class="sc">~</span> <span class="st">"Suspected"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="step-6.3-review-the-distribution-of-laboratory-results-among-cases" class="level3">
<h3 class="anchored" data-anchor-id="step-6.3-review-the-distribution-of-laboratory-results-among-cases">Step 6.3 Review the distribution of laboratory results among cases</h3>
<section id="task-a-use-tabyl-to-tabulate-case-category" class="level4">
<h4 class="anchored" data-anchor-id="task-a-use-tabyl-to-tabulate-case-category"><strong>Task A: Use <code>tabyl()</code> to tabulate case category</strong></h4>
<p>Use <code>tabyl()</code> overall, and also cross-tabulate by disease to answer the questions below.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Questions
</div>
</div>
<div class="callout-body-container callout-body">
<div class="webex-check">
How many cases in the linked notification data did not have a positive or negative result?
<div id="radio_PMKNXIBGPH" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_PMKNXIBGPH" value="answer"> <span>202</span></label><label><input type="radio" autocomplete="off" name="radio_PMKNXIBGPH" value=""> <span>347</span></label><label><input type="radio" autocomplete="off" name="radio_PMKNXIBGPH" value=""> <span>250</span></label>
</div>
What percentage of cases in the notification data DID have a positive or negative result?
<div id="radio_XCNENGVYSJ" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_XCNENGVYSJ" value=""> <span>60.1%</span></label><label><input type="radio" autocomplete="off" name="radio_XCNENGVYSJ" value="answer"> <span>79.5%</span></label><label><input type="radio" autocomplete="off" name="radio_XCNENGVYSJ" value=""> <span>92.2%</span></label>
</div>
Why are there more remaining suspected cases than there are unlinked notifications?
<div id="radio_CQAKAVWLWZ" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_CQAKAVWLWZ" value="answer"> <span>Suspected cases include notifications without a lab result and with an indeterminate lab result</span></label><label><input type="radio" autocomplete="off" name="radio_CQAKAVWLWZ" value=""> <span>There are additional suspected cases being brought in from the lab</span></label><label><input type="radio" autocomplete="off" name="radio_CQAKAVWLWZ" value=""> <span>There is an issue with the data</span></label>
</div>
Which disease had the highest percentage of cases that remained suspected after linkage?
<div id="radio_CRSUNAUKFI" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_CRSUNAUKFI" value=""> <span>Cholera</span></label><label><input type="radio" autocomplete="off" name="radio_CRSUNAUKFI" value=""> <span>Malaria</span></label><label><input type="radio" autocomplete="off" name="radio_CRSUNAUKFI" value=""> <span>Dengue</span></label><label><input type="radio" autocomplete="off" name="radio_CRSUNAUKFI" value="answer"> <span>Yellow fever</span></label>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-48-contents" aria-controls="callout-48" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the solution (try it yourself first!)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-48" class="callout-48-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Once again you can use <code>tabyl()</code> to see the distribution of case categories across notifications. The total number of suspected cases, i.e.&nbsp;those with either no lab result at all or with an indeterminate result, is 202. This means 785 cases, i.e.&nbsp;79.5%, did have a definitive laboratory result.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(data_linked, case_category) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> case_category   n   percent
     Confirmed 438 0.4437690
     Discarded 347 0.3515704
     Suspected 202 0.2046606</code></pre>
</div>
</div>
<p>You can also cross-tabulate the original results (indeterminate/negative/positive) in the <code>value</code> column with the new <code>case_category</code> column, firstly to check your logic worked, and to see how the original values map to the new column values. This shows that in addition to the 129 notifications that were not linked (with <code>NA</code> in the <code>value</code> column), 73 had indeterminate results, so were categorized as suspected cases.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(data_linked, case_category, value) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> case_category Indeterminate Negative Positive NA_
     Confirmed             0        0      438   0
     Discarded             0      347        0   0
     Suspected            73        0        0 129</code></pre>
</div>
</div>
<p>Finally, you can also cross-tabulate with the disease name to see the case categories by disease. Add additional <code>adorn_xxx()</code> functions for percentage formatting. The table shows you that 22% of yellow fever cases remained suspected, which was the highest percentage compared to the other diseases.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(data_linked, disease_notified, case_category) <span class="sc">|&gt;</span> </span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(<span class="at">where =</span> <span class="st">"both"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_percentages</span>() <span class="sc">|&gt;</span> </span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_pct_formatting</span>() <span class="sc">|&gt;</span> </span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_ns</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> disease_notified   Confirmed   Discarded   Suspected        Total
          cholera 82.6%  (38)  4.3%   (2) 13.0%   (6) 100.0%  (46)
           dengue 68.1% (186) 10.6%  (29) 21.2%  (58) 100.0% (273)
          malaria 32.6% (174) 46.3% (247) 21.0% (112) 100.0% (533)
          typhoid 20.0%   (7) 68.6%  (24) 11.4%   (4) 100.0%  (35)
     yellow fever 33.0%  (33) 45.0%  (45) 22.0%  (22) 100.0% (100)
            Total 44.4% (438) 35.2% (347) 20.5% (202) 100.0% (987)</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="task-b-assess-the-percentage-of-suspected-cases-that-are-indeed-true-cases" class="level4">
<h4 class="anchored" data-anchor-id="task-b-assess-the-percentage-of-suspected-cases-that-are-indeed-true-cases"><strong>Task B: Assess the percentage of suspected cases that are indeed true cases</strong></h4>
<p>Use <code>tabyl()</code> for this once again, looking at the results by disease. Think about the correct denominator!</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Questions
</div>
</div>
<div class="callout-body-container callout-body">
<div class="webex-check">
What percentage of suspected cases reported in 2024 were true cases, according to their test results?
<div id="radio_TPSATEWDQE" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_TPSATEWDQE" value=""> <span>44%</span></label><label><input type="radio" autocomplete="off" name="radio_TPSATEWDQE" value="answer"> <span>56%</span></label><label><input type="radio" autocomplete="off" name="radio_TPSATEWDQE" value=""> <span>59%</span></label>
</div>
What percentage of suspected malaria cases were really malaria?
<div id="radio_UPUJHGVDPG" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_UPUJHGVDPG" value=""> <span>86%</span></label><label><input type="radio" autocomplete="off" name="radio_UPUJHGVDPG" value="answer"> <span>41%</span></label><label><input type="radio" autocomplete="off" name="radio_UPUJHGVDPG" value=""> <span>23%</span></label>
</div>
What percentage of suspected dengue cases were really dengue?
<div id="radio_CWVDIADHHZ" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_CWVDIADHHZ" value="answer"> <span>87%</span></label><label><input type="radio" autocomplete="off" name="radio_CWVDIADHHZ" value=""> <span>41%</span></label><label><input type="radio" autocomplete="off" name="radio_CWVDIADHHZ" value=""> <span>23%</span></label>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-50-contents" aria-controls="callout-50" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to read a hint
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-50" class="callout-50-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Divide the number of confirmed cases (i.e.&nbsp;those with a positive result) by the number of confirmed plus discarded cases (i.e.&nbsp;those with either a positive or negative result). This gives a positivity rate, which approximates the percentage of suspected cases that were truly cases. Indeterminate results are excluded because they don’t provide a clear outcome and would skew the positivity rate.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-51-contents" aria-controls="callout-51" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the solution (try it yourself first!)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-51" class="callout-51-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Filter out suspected cases and then cross-tabulate, to see the percentage of originally suspected cases that become confirmed or discarded, among those with valid test results.</p>
<p>Because there is a totals row, you can see that 56% of suspected cases overall became confirmed, among those with a valid result. You can also see that 41% and 87% of malaria and dengue cases respectively were confirmed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>data_linked <span class="sc">|&gt;</span> </span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(case_category <span class="sc">!=</span> <span class="st">"Suspected"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(disease_notified, case_category) <span class="sc">|&gt;</span> </span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(<span class="at">where =</span> <span class="st">"both"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_percentages</span>() <span class="sc">|&gt;</span> </span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_pct_formatting</span>() <span class="sc">|&gt;</span> </span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_ns</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> disease_notified   Confirmed   Discarded        Total
          cholera 95.0%  (38)  5.0%   (2) 100.0%  (40)
           dengue 86.5% (186) 13.5%  (29) 100.0% (215)
          malaria 41.3% (174) 58.7% (247) 100.0% (421)
          typhoid 22.6%   (7) 77.4%  (24) 100.0%  (31)
     yellow fever 42.3%  (33) 57.7%  (45) 100.0%  (78)
            Total 55.8% (438) 44.2% (347) 100.0% (785)</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="step-6.4-create-a-linelist-with-just-confirmed-cases" class="level3">
<h3 class="anchored" data-anchor-id="step-6.4-create-a-linelist-with-just-confirmed-cases">Step 6.4 Create a linelist with just confirmed cases</h3>
<p><strong>Task A: Create a new linelist called <code>data_linked_confirmed</code></strong>.</p>
<p>This is what you will use in official surveillance reporting.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Questions
</div>
</div>
<div class="callout-body-container callout-body">
<div class="webex-check">
Why are we opting to report only confirmed cases in our surveillance data?
<div id="radio_SVTQQETXKN" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_SVTQQETXKN" value="answer"> <span>Reporting confirmed cases can be more reliable and accurate when the percentage testing positive is low and lab testing is routine, thereby helping prevent over-estimation of disease burden</span></label><label><input type="radio" autocomplete="off" name="radio_SVTQQETXKN" value=""> <span>Reporting confirmed cases is slower, which gives us more time to be sure of what we are reporting</span></label><label><input type="radio" autocomplete="off" name="radio_SVTQQETXKN" value=""> <span>Because we want to hide the true number of cases</span></label>
</div>
What function is important for creating the new linelist?
<div id="radio_SFSNKOKPKJ" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_SFSNKOKPKJ" value="answer"> <span>filter()</span></label><label><input type="radio" autocomplete="off" name="radio_SFSNKOKPKJ" value=""> <span>arrange()</span></label><label><input type="radio" autocomplete="off" name="radio_SFSNKOKPKJ" value=""> <span>mutate()</span></label>
</div>
How many rows are in this new data frame?
<div id="radio_PPAITIGDET" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_PPAITIGDET" value=""> <span>389</span></label><label><input type="radio" autocomplete="off" name="radio_PPAITIGDET" value="answer"> <span>438</span></label><label><input type="radio" autocomplete="off" name="radio_PPAITIGDET" value=""> <span>858</span></label>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-53-contents" aria-controls="callout-53" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the solution (try it yourself first!)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-53" class="callout-53-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Your surveillance unit wants to focus on confirmed cases in reporting. This is because lab testing is routine in Feveria, and so reporting suspected cases would be unnecessarily inaccurate, with a high percentage of suspected cases getting discarded.</p>
<p>The decision to publish suspected cases may be different in other contexts. For example, if the positivity rate is high (most cases are true cases if tested), and testing itself is not common, or testing takes a long time and would result in delayed reporting, this would suggest that suspected case trends are sufficiently accurate and also more timely than waiting for laboratory confirmation.</p>
<p>Create the new linelist with the <code>filter()</code> function:</p>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>data_linked_confirmed <span class="ot">&lt;-</span> data_linked <span class="sc">|&gt;</span> </span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(case_category<span class="sc">==</span><span class="st">"Confirmed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>And check the number of rows by looking at the information in your environment, or with <code>nrow()</code>:</p>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(data_linked_confirmed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>[1] 438</p>
</div>
</div>
</div>
</section>
</section>
<section id="step-7.-descriptive-analysis-of-confirmed-cases" class="level2">
<h2 class="anchored" data-anchor-id="step-7.-descriptive-analysis-of-confirmed-cases">Step 7. Descriptive analysis of confirmed cases</h2>
<p>Now that you have your linelist of confirmed notifiable disease cases reported in Feveria in 2024, you are ready to conduct the final part of your surveillance analysis! Namely, this is to summarize the five notifiable diseases by geography and time.</p>
<p><strong>Tip</strong>: Typically surveillance analysis would also include analysis by person. You could expand on this case study by also analyzing by demographic variables.</p>
<section id="step-7.1-describe-cases-by-district" class="level3">
<h3 class="anchored" data-anchor-id="step-7.1-describe-cases-by-district">Step 7.1 Describe cases by district</h3>
<section id="task-a-produce-a-table-of-confirmed-cases-by-district-using-tabyl-and-adorn_xxx-functions-including-totals" class="level4">
<h4 class="anchored" data-anchor-id="task-a-produce-a-table-of-confirmed-cases-by-district-using-tabyl-and-adorn_xxx-functions-including-totals"><strong>Task A: Produce a table of confirmed cases by district using <code>tabyl()</code> and <code>adorn_xxx()</code> functions, including totals</strong></h4>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Questions
</div>
</div>
<div class="callout-body-container callout-body">
<div class="webex-check">
Which notifiable disease was most commonly reported in 2024, when restricting to only confirmed cases?
<div id="radio_RQWDYRSODC" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_RQWDYRSODC" value="answer"> <span>Dengue</span></label><label><input type="radio" autocomplete="off" name="radio_RQWDYRSODC" value=""> <span>Malaria</span></label><label><input type="radio" autocomplete="off" name="radio_RQWDYRSODC" value=""> <span>Yellow Fever</span></label>
</div>
Why is the most commonly reported disease different when looking at confirmed and suspected cases?
<div id="radio_CNBQBNSBVL" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_CNBQBNSBVL" value=""> <span>The sensitivity and specificity of the clinical diagnosis may differ by disease</span></label><label><input type="radio" autocomplete="off" name="radio_CNBQBNSBVL" value=""> <span>The performance of the tests used in the lab may differ by disease</span></label><label><input type="radio" autocomplete="off" name="radio_CNBQBNSBVL" value=""> <span>There may be reporting biases</span></label><label><input type="radio" autocomplete="off" name="radio_CNBQBNSBVL" value="answer"> <span>All of the above!</span></label>
</div>
Which district reported the most confirmed cholera cases in 2024?
<div id="radio_UXAPVGOOGI" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_UXAPVGOOGI" value=""> <span>Lake Minara</span></label><label><input type="radio" autocomplete="off" name="radio_UXAPVGOOGI" value="answer"> <span>Feveria Central</span></label><label><input type="radio" autocomplete="off" name="radio_UXAPVGOOGI" value=""> <span>Kasara</span></label>
</div>
How many confirmed cases of cholera reported in 2024 were among residents of Feveria Central?
<div id="radio_XXDODSYOEO" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_XXDODSYOEO" value="answer"> <span>35</span></label><label><input type="radio" autocomplete="off" name="radio_XXDODSYOEO" value=""> <span>42</span></label><label><input type="radio" autocomplete="off" name="radio_XXDODSYOEO" value=""> <span>4</span></label>
</div>
Which district reported the most confirmed malaria cases in 2024?
<div id="radio_NIWZXMJGED" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_NIWZXMJGED" value="answer"> <span>Lake Minara</span></label><label><input type="radio" autocomplete="off" name="radio_NIWZXMJGED" value=""> <span>Feveria Central</span></label><label><input type="radio" autocomplete="off" name="radio_NIWZXMJGED" value=""> <span>Kasara</span></label>
</div>
Does this data confirm that dengue is the most common infectious disease in Feveria?
<div id="radio_ZJQZATSMAK" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_ZJQZATSMAK" value="answer"> <span>No - a different disease may be under-reported and/or not notifiable</span></label><label><input type="radio" autocomplete="off" name="radio_ZJQZATSMAK" value=""> <span>Yes - if it's most reported then it must be most common</span></label>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-55-contents" aria-controls="callout-55" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the solution (try it yourself first!)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-55" class="callout-55-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Using <code>tabyl()</code>, we can see that dengue was the most commonly reported disease in Feveria in 2024 when restricting to confirmed cases, with 186 cases.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>data_linked_confirmed <span class="sc">|&gt;</span> </span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(disease_notified) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> disease_notified   n    percent
          cholera  38 0.08675799
           dengue 186 0.42465753
          malaria 174 0.39726027
          typhoid   7 0.01598174
     yellow fever  33 0.07534247</code></pre>
</div>
</div>
<p>Note that this is different from the suspected cases, where malaria was most commonly reported (with 533 suspected cases)! This was hinted at previously, when you saw that the positivity rate for suspected dengue cases was higher than for suspected malaria cases. This can be for different reasons, for instance the clinical diagnosis method used for malaria may be less specific (so many of the suspected cases are actually other diseases), or the test used for dengue may be more sensitive.</p>
<p>To cross-tabulate with residential district, add the relevant <code>adorn_xxx()</code> functions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>data_linked_confirmed <span class="sc">|&gt;</span> </span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(disease_notified, residential_district) <span class="sc">|&gt;</span> </span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(<span class="at">where =</span> <span class="st">"both"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_percentages</span>() <span class="sc">|&gt;</span> </span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_pct_formatting</span>() <span class="sc">|&gt;</span> </span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_ns</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> disease_notified Feveria Central     Kasara Lake Minara        Total
          cholera      92.1% (35)  7.9%  (3)  0.0%   (0) 100.0%  (38)
           dengue       8.6% (16) 17.2% (32) 74.2% (138) 100.0% (186)
          malaria      14.9% (26) 22.4% (39) 62.6% (109) 100.0% (174)
          typhoid      71.4%  (5) 28.6%  (2)  0.0%   (0) 100.0%   (7)
     yellow fever       0.0%  (0) 18.2%  (6) 81.8%  (27) 100.0%  (33)
            Total      18.7% (82) 18.7% (82) 62.6% (274) 100.0% (438)</code></pre>
</div>
</div>
<p>Like with the suspected cases, we can see that most confirmed cases of dengue, malaria, and yellow fever were located in Lake Minara - the lake area with higher density of mosquitoes and therefore vector-borne disease. The majority of confirmed cholera and typhoid fever cases were in Feveria Central, where there are water and sanitation issues.</p>
<p>The data suggests that vector-borne disease (dengue and malaria) are a particular concern in this tropical country. However, we don’t know for sure which is the most common disease and what the underlying patterns are - only five diseases are notifiable, and typically the reported cases only represent a fraction of true cases in the community.</p>
</div>
</div>
</div>
</section>
</section>
<section id="step-7.2-describe-cases-over-time" class="level3">
<h3 class="anchored" data-anchor-id="step-7.2-describe-cases-over-time">Step 7.2 Describe cases over time</h3>
<p>You are going to work towards producing this epicurve, over the various tasks below.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multidisease_surveillance_files/figure-html/unnamed-chunk-91-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<section id="task-a-start-by-using-ggplot-and-geom_histogram-to-produce-one-overall-epicurve-for-feveria-showing-case-counts-by-report-week-with-bars-stacked-and-colored-by-disease" class="level4">
<h4 class="anchored" data-anchor-id="task-a-start-by-using-ggplot-and-geom_histogram-to-produce-one-overall-epicurve-for-feveria-showing-case-counts-by-report-week-with-bars-stacked-and-colored-by-disease"><strong>Task A: Start by using <code>ggplot()</code> and <code>geom_histogram()</code> to produce one overall epicurve for Feveria, showing case counts by report week, with bars stacked and colored by disease</strong></h4>
<p>Make sure you specify the argument <code>binwidth=7</code> so that each bar in the histogram represents the number of cases within a 7 day period.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Questions
</div>
</div>
<div class="callout-body-container callout-body">
<div class="webex-check">
When was the first case of typhoid fever reported in Feveria in 2024?
<div id="radio_VHOHSYYHRB" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_VHOHSYYHRB" value=""> <span>January 2024</span></label><label><input type="radio" autocomplete="off" name="radio_VHOHSYYHRB" value="answer"> <span>May 2024</span></label><label><input type="radio" autocomplete="off" name="radio_VHOHSYYHRB" value=""> <span>October 2024</span></label>
</div>
According to this graph, what was the highest number of dengue cases reported in a single week in 2024?
<div id="radio_HZXPPBJJTR" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_HZXPPBJJTR" value=""> <span>10</span></label><label><input type="radio" autocomplete="off" name="radio_HZXPPBJJTR" value=""> <span>20</span></label><label><input type="radio" autocomplete="off" name="radio_HZXPPBJJTR" value=""> <span>30</span></label><label><input type="radio" autocomplete="off" name="radio_HZXPPBJJTR" value="answer"> <span>It's very hard to tell from this stacked graph!</span></label>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-57-contents" aria-controls="callout-57" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the solution (try it yourself first!)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-57" class="callout-57-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Here is some simple code to produce the epicurve. Note that you are not controlling the colors just yet, or specifying what day of the week each 7-day period starts on.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>data_linked_confirmed <span class="sc">|&gt;</span> </span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>((<span class="fu">aes</span>(<span class="at">x =</span> date_report, <span class="at">fill =</span> disease_notified)), <span class="at">binwidth=</span><span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multidisease_surveillance_files/figure-html/unnamed-chunk-93-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Refer to the <a href="https://epirhandbook.com/en/new_pages/dates.html">dates chapter in the Epi R Handbook</a> if you want more specific date formatting, for instance so that each bar represents a Monday-Sunday week, or the x axis labels the week number (weeks 1 - 52).</p>
<p>Importantly - it is not straight forward to see the trends per disease when stacked this way! To see such temporal trends, you should produce one histogram per disease.</p>
</div>
</div>
</div>
</section>
<section id="task-b-use-ggplot-to-produce-an-epicurve-showing-case-counts-by-report-week-faceted-and-not-stacked-by-disease" class="level4">
<h4 class="anchored" data-anchor-id="task-b-use-ggplot-to-produce-an-epicurve-showing-case-counts-by-report-week-faceted-and-not-stacked-by-disease"><strong>Task B: Use <code>ggplot()</code> to produce an epicurve showing case counts by report week, faceted (and not stacked) by disease</strong></h4>
<p>Use <code>facet_wrap()</code> to easily create several mini-plots, one per disease. To understand this further, you can look at the <a href="https://epirhandbook.com/en/new_pages/ggplot_basics.html#ggplot_basics_facet">facet section of the ggplot2 chapter in the Epi R Handbook</a></p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Questions
</div>
</div>
<div class="callout-body-container callout-body">
<div class="webex-check">
According to this faceted graph, what was the highest number of dengue cases reported in a single week in 2024?
<div id="radio_ACZGWESXVK" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_ACZGWESXVK" value=""> <span>11</span></label><label><input type="radio" autocomplete="off" name="radio_ACZGWESXVK" value="answer"> <span>15</span></label><label><input type="radio" autocomplete="off" name="radio_ACZGWESXVK" value=""> <span>29</span></label><label><input type="radio" autocomplete="off" name="radio_ACZGWESXVK" value=""> <span>I still can't tell!</span></label>
</div>
Among the dengue cases reported that week, what districts did they live in?
<div id="radio_MPDCXWLHZX" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_MPDCXWLHZX" value=""> <span>All three districts</span></label><label><input type="radio" autocomplete="off" name="radio_MPDCXWLHZX" value=""> <span>Feveria Central</span></label><label><input type="radio" autocomplete="off" name="radio_MPDCXWLHZX" value=""> <span>Kasara</span></label><label><input type="radio" autocomplete="off" name="radio_MPDCXWLHZX" value=""> <span>Lake Minara</span></label><label><input type="radio" autocomplete="off" name="radio_MPDCXWLHZX" value="answer"> <span>This graph does not show this information</span></label>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-59-contents" aria-controls="callout-59" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the solution (try it yourself first!)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-59" class="callout-59-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Now you can see an epicurve per disease! And you can see that during one week in July, 15 cases of dengue were reported. However, this graph does not show any geographical information yet.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>data_linked_confirmed <span class="sc">|&gt;</span> </span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>((<span class="fu">aes</span>(<span class="at">x =</span> date_report)), <span class="at">binwidth=</span><span class="dv">7</span>) <span class="sc">+</span> </span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span>disease_notified)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multidisease_surveillance_files/figure-html/unnamed-chunk-95-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="task-c-now-add-a-fill-color-to-your-faceted-graph-so-that-the-bars-are-stacked-by-district" class="level4">
<h4 class="anchored" data-anchor-id="task-c-now-add-a-fill-color-to-your-faceted-graph-so-that-the-bars-are-stacked-by-district"><strong>Task C: Now add a fill color to your faceted graph so that the bars are stacked by district</strong></h4>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Questions
</div>
</div>
<div class="callout-body-container callout-body">
<div class="webex-check">
Among the 15 dengue cases reported in one week in July 2024, what districts did they live in?
<div id="radio_RQXKCXZEAH" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_RQXKCXZEAH" value="answer"> <span>All three districts</span></label><label><input type="radio" autocomplete="off" name="radio_RQXKCXZEAH" value=""> <span>Feveria Central</span></label><label><input type="radio" autocomplete="off" name="radio_RQXKCXZEAH" value=""> <span>Kasara</span></label><label><input type="radio" autocomplete="off" name="radio_RQXKCXZEAH" value=""> <span>Lake Minara</span></label>
</div>
In what district was the first typhoid fever case reported in 2024?
<div id="radio_EAGBVOSCVU" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_EAGBVOSCVU" value=""> <span>Kasara</span></label><label><input type="radio" autocomplete="off" name="radio_EAGBVOSCVU" value="answer"> <span>Feveria Central</span></label><label><input type="radio" autocomplete="off" name="radio_EAGBVOSCVU" value=""> <span>Lake Minara</span></label><label><input type="radio" autocomplete="off" name="radio_EAGBVOSCVU" value=""> <span>I still can't tell!</span></label>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-61-contents" aria-controls="callout-61" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the solution (try it yourself first!)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-61" class="callout-61-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Now you can see an epicurve per disease, with the coloring reflecting the district the case is a resident of.</p>
<p>You can see that among the 15 dengue cases reported in a single week, they lived across the three different districts. You can also see that the first case of typhoid was reported in Feveria Central.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>data_linked_confirmed <span class="sc">|&gt;</span> </span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>((<span class="fu">aes</span>(<span class="at">x =</span> date_report, <span class="at">fill =</span> residential_district)), <span class="at">binwidth=</span><span class="dv">7</span>) <span class="sc">+</span> </span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span>disease_notified)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multidisease_surveillance_files/figure-html/unnamed-chunk-97-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="task-d-add-further-formatting-to-your-faceted-plot-so-it-is-publication-ready" class="level4">
<h4 class="anchored" data-anchor-id="task-d-add-further-formatting-to-your-faceted-plot-so-it-is-publication-ready"><strong>Task D: Add further formatting to your faceted plot so it is publication-ready</strong></h4>
<p>You can specify:</p>
<ul>
<li>The theme/appearance of the overall graph (e.g.&nbsp;background color, appearance of grid lines)</li>
<li>The title and labels</li>
<li>The colors of the bars (with <code>scale_fill_manual()</code>)</li>
<li>The formatting and spacing of dates along the x-axis (with <code>scale_x_date</code>)</li>
<li>Many other things!</li>
</ul>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Questions
</div>
</div>
<div class="callout-body-container callout-body">
<div class="webex-check">
Do cholera and typhoid fever appear endemic?
<div id="radio_LETOTGEWPL" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_LETOTGEWPL" value="answer"> <span>No - the data suggests smaller occasional outbreaks</span></label><label><input type="radio" autocomplete="off" name="radio_LETOTGEWPL" value=""> <span>Yes they are both endemic</span></label>
</div>
Is there a particular time of the year when malaria peaked in 2024?
<div id="radio_NHLNGWODKR" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_NHLNGWODKR" value=""> <span>Yes - around November/December time</span></label><label><input type="radio" autocomplete="off" name="radio_NHLNGWODKR" value="answer"> <span>Yes - around July/August (summer) time</span></label><label><input type="radio" autocomplete="off" name="radio_NHLNGWODKR" value=""> <span>No, it is consistently high</span></label>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-63-contents" aria-controls="callout-63" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the solution (try it yourself first!)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-63" class="callout-63-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Here is the fully formatted code. Note some other changes include specifying that we only want two columns of mini-plots within <code>facet_wrap()</code>, and that the date label along the x axis should only show day and month (not year, since all cases are in 2024 anyway).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>data_linked_confirmed <span class="sc">|&gt;</span> </span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>((<span class="fu">aes</span>(<span class="at">x =</span> date_report, <span class="at">fill =</span> residential_district)), <span class="at">binwidth=</span><span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span>disease_notified, <span class="at">ncol=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"District of residence"</span>,</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Date reported by clinic"</span>,</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>,</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Number of confirmed cholera, dengue, malaria, typhoid fever, and yellow fever cases by week in Feveria, 2024"</span>) <span class="sc">+</span></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"navy"</span>, <span class="st">"lightblue"</span>, <span class="st">"seagreen"</span>)) <span class="sc">+</span></span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_breaks =</span> <span class="st">"1 month"</span>, </span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">date_labels =</span> <span class="st">"%d %b"</span>) <span class="sc">+</span></span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>,</span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multidisease_surveillance_files/figure-html/unnamed-chunk-99-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can also see from the epicurve that cholera and typhoid appear to be occurring as isolated outbreaks, rather than showing endemicity. Malaria and dengue however were present in Feveria throughout the year, with malaria more obviously peaking in the summer months.</p>
</div>
</div>
</div>
</section>
<section id="task-e-produce-table-summarizing-dates" class="level4">
<h4 class="anchored" data-anchor-id="task-e-produce-table-summarizing-dates"><strong>Task E: Produce table summarizing dates</strong></h4>
<p>This time, use <code>group_by()</code> and <code>summarize()</code> to produce a table by district showing the earliest and latest report dates.</p>
<p>You can adjust your table with a <code>filter()</code> function to create this table for one district at a time.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Questions
</div>
</div>
<div class="callout-body-container callout-body">
<div class="webex-check">
When was the first dengue case reported in <strong>Feveria</strong> in 2024?
<div id="radio_LEBVJTFEMQ" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_LEBVJTFEMQ" value=""> <span>18th January 2024</span></label><label><input type="radio" autocomplete="off" name="radio_LEBVJTFEMQ" value="answer"> <span>17th January 2024</span></label><label><input type="radio" autocomplete="off" name="radio_LEBVJTFEMQ" value=""> <span>12th February 2024</span></label>
</div>
When was the last dengue case reported in <strong>Feveria Central</strong> in 2024?
<div id="radio_QRIJYZTEAI" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_QRIJYZTEAI" value="answer"> <span>22nd August 2024</span></label><label><input type="radio" autocomplete="off" name="radio_QRIJYZTEAI" value=""> <span>18th November 2024</span></label><label><input type="radio" autocomplete="off" name="radio_QRIJYZTEAI" value=""> <span>25th December 2024</span></label>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-65-contents" aria-controls="callout-65" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the solution (try it yourself first!)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-65" class="callout-65-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Group the data by disease and then <code>summarize</code> the first and last date to look at the overall timeline of each disease in Feveria.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>data_linked_confirmed <span class="sc">|&gt;</span> </span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(disease_notified) <span class="sc">|&gt;</span> </span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">first_reported =</span> <span class="fu">min</span>(date_report), </span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">last_reported =</span> <span class="fu">max</span>(date_report)) <span class="sc">|&gt;</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  disease_notified first_reported last_reported
  &lt;chr&gt;            &lt;date&gt;         &lt;date&gt;       
1 cholera          2024-06-03     2024-09-23   
2 dengue           2024-01-17     2024-11-18   
3 malaria          2024-01-08     2024-12-25   
4 typhoid          2024-05-02     2024-11-07   
5 yellow fever     2024-03-08     2024-08-23   </code></pre>
</div>
</div>
<p>Add a <code>filter()</code> to the code to look at first and most recent report dates for the district you’re interested in.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>data_linked_confirmed <span class="sc">|&gt;</span> </span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(residential_district <span class="sc">==</span> <span class="st">"Feveria Central"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(disease_notified) <span class="sc">|&gt;</span> </span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">first_reported =</span> <span class="fu">min</span>(date_report), </span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">recent_reported =</span> <span class="fu">max</span>(date_report)) <span class="sc">|&gt;</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  disease_notified first_reported recent_reported
  &lt;chr&gt;            &lt;date&gt;         &lt;date&gt;         
1 cholera          2024-06-03     2024-09-23     
2 dengue           2024-01-29     2024-08-22     
3 malaria          2024-01-29     2024-12-17     
4 typhoid          2024-05-02     2024-11-07     </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>Wow! In line with the objectives for this case study, you have done the following:</p>
<ol type="1">
<li><p>You used key R functions to clean, reshape, and link data frames, plus created new columns using logical conditions.</p></li>
<li><p>To inform the data processing, you conducted data inspections and checks along the way</p></li>
<li><p>You conducted a thorough descriptive analysis to understand the testing and notification data, before and after linkage. In response to your supervisor’s original four questions, you can say:</p>
<ul>
<li><strong>How many suspected cases of the different notifiable diseases were reported in 2024, and which was most common?</strong> Malaria was the most common notifiable disease in Feveria in 2024, reported through the notifiable disease surveillance system: There were 533 suspected cases of malaria reported, 273 suspected cases of dengue, 100 yellow fever, 46 cholera, and 35 typhoid.</li>
<li><strong>What percentage of them ended up being confirmed?</strong> Almost 80% of notifiable cases reported in 2024 had a laboratory test result by the time the linked dataset was created, with some variation by disease. In total, 56% of notified cases were eventually confirmed, but this ranged from only 23% for typhoid fever (7 confirmed of 31 suspected cases with test results), to 95% for cholera (38 confirmed of 40 suspected cases with rest results). Additionally, the positivity rate was higher for suspected dengue than for suspected malaria (87% vs 41%).</li>
<li><strong>How many confirmed cases of different notifiable diseases were reported in 2024, and which was most common?</strong> Confirmed cases followed a slightly different trend to suspected cases: the most commonly reported infection was dengue with 186 cases, followed by malaria (174), then cholera (38), yellow fever (33), and typhoid fever (7).</li>
<li><strong>How are confirmed cases geographically and temporally distributed in Feveria?</strong> Feveria experienced dengue and malaria transmission throughout the year, peaking in the summer, and concentrated in the Lake Minara district. Feveria also experienced small and infrequent outbreaks of diarrhoeal disease, e.g.&nbsp;cholera and typhoid fever, particularly in the urban Feveria Central where there can be issues with water and sanitation.</li>
</ul></li>
<li><p>Finally, you have reflected on how the processes involved in notifiable disease surveillance systems and lab testing, for instance the transfer of data between clinics to labs, can affect data quality and completeness, and therefore your results.</p></li>
</ol>
<p>There is so much more potential ahead. You can explore disease patterns by age or sex, calculate disease rates with population data, and even analyze reporting delays by examining the different dates in your datasets.</p>
<p>You have built a strong foundation and are well equipped to take your analysis to the next level. Keep going — exciting discoveries await!</p>
<p>To learn more, check out the other case studies or dive into the <a href="https://www.epirhandbook.com">Epi R Handbook</a>.</p>
</section>
<section id="data-cleaning-and-analysis-code" class="level2">
<h2 class="anchored" data-anchor-id="data-cleaning-and-analysis-code">Data cleaning and analysis code</h2>
<p>See below a script of all data cleaning steps and descriptive analyses. Note how the analyses are combined at the end rather than interspersed in between cleaning steps. This is a tidier way to organize your script.</p>
<p>For brevity, the code below does not include all inspections and checks made along the way, but you may decide to create a sections with such checks.</p>
<p>The top of your script should also contain information to help the reader understand what the script is for, as well as comments throughout. You will thank yourself later for adding these comments!</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-66-contents" aria-controls="callout-66" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code to clean and analyse notification data and lab data from Feveria, 2024
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-66" class="callout-66-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Code to clean and analyse notification data and lab data from Feveria, 2024</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Date:</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Author:</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Install packages -------------------------------------------------</span></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensures the package "pacman" is installed</span></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">"pacman"</span>)) {</span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>     <span class="fu">install.packages</span>(<span class="st">"pacman"</span>) }</span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a><span class="co"># install (if necessary) from CRAN and load packages to be used</span></span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>  rio,        <span class="co"># importing data  </span></span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>  skimr,      <span class="co"># get overview of data</span></span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a>  janitor,    <span class="co"># data cleaning and tables</span></span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a>  lubridate,  <span class="co"># working with dates</span></span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a>  epikit,     <span class="co"># to create age categories</span></span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a>  gtsummary,  <span class="co"># summary statistics, tests and regressions </span></span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a>  apyramid,   <span class="co"># plotting age pyramids </span></span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a>  flextable,  <span class="co"># Presentation ready tables</span></span>
<span id="cb115-20"><a href="#cb115-20" aria-hidden="true" tabindex="-1"></a>  naniar,     <span class="co"># Evaluating missingness of data</span></span>
<span id="cb115-21"><a href="#cb115-21" aria-hidden="true" tabindex="-1"></a>  remotes,    <span class="co"># Used to install package to download data</span></span>
<span id="cb115-22"><a href="#cb115-22" aria-hidden="true" tabindex="-1"></a>  tidyverse   <span class="co"># data management and visualization</span></span>
<span id="cb115-23"><a href="#cb115-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb115-24"><a href="#cb115-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-25"><a href="#cb115-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Import data --------------------------------------------</span></span>
<span id="cb115-26"><a href="#cb115-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-27"><a href="#cb115-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Notification data</span></span>
<span id="cb115-28"><a href="#cb115-28" aria-hidden="true" tabindex="-1"></a>data_notif_raw <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">"data/multidisease_notifications.xlsx"</span>)</span>
<span id="cb115-29"><a href="#cb115-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-30"><a href="#cb115-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Lab data</span></span>
<span id="cb115-31"><a href="#cb115-31" aria-hidden="true" tabindex="-1"></a>data_lab_raw <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">"data/multidisease_tests.csv"</span>)</span>
<span id="cb115-32"><a href="#cb115-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-33"><a href="#cb115-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean notification data --------------------------------</span></span>
<span id="cb115-34"><a href="#cb115-34" aria-hidden="true" tabindex="-1"></a>data_notif <span class="ot">&lt;-</span> data_notif_raw <span class="sc">|&gt;</span> </span>
<span id="cb115-35"><a href="#cb115-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb115-36"><a href="#cb115-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">date_report =</span> date_reported_by_health_facility_community) <span class="sc">|&gt;</span> </span>
<span id="cb115-37"><a href="#cb115-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(notification_id, residential_district, disease_notified, date_report) <span class="sc">|&gt;</span> </span>
<span id="cb115-38"><a href="#cb115-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">residential_district =</span> <span class="fu">case_match</span>(<span class="fu">str_to_title</span>(residential_district),</span>
<span id="cb115-39"><a href="#cb115-39" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">c</span>(<span class="st">"F Central"</span>, <span class="st">"Feveria C"</span>, <span class="st">"Feveria Central"</span>) <span class="sc">~</span> <span class="st">"Feveria Central"</span>,</span>
<span id="cb115-40"><a href="#cb115-40" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">c</span>(<span class="st">"Kasara"</span>, <span class="st">"Ksr"</span>) <span class="sc">~</span> <span class="st">"Kasara"</span>,</span>
<span id="cb115-41"><a href="#cb115-41" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">c</span>(<span class="st">"L Minara"</span>, <span class="st">"Lake Minara"</span>, <span class="st">"Lakeside"</span>) <span class="sc">~</span> <span class="st">"Lake Minara"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb115-42"><a href="#cb115-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date_report =</span> <span class="fu">ymd</span>(date_report)) </span>
<span id="cb115-43"><a href="#cb115-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-44"><a href="#cb115-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-45"><a href="#cb115-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean and consolidate lab data  ---------------------------------------</span></span>
<span id="cb115-46"><a href="#cb115-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean values</span></span>
<span id="cb115-47"><a href="#cb115-47" aria-hidden="true" tabindex="-1"></a>data_lab <span class="ot">&lt;-</span> data_lab_raw <span class="sc">|&gt;</span> </span>
<span id="cb115-48"><a href="#cb115-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">case_match</span>(value, </span>
<span id="cb115-49"><a href="#cb115-49" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">c</span>(<span class="st">"P"</span>, <span class="st">"PO1"</span>, <span class="st">"PO139"</span>) <span class="sc">~</span> <span class="st">"Positive"</span>,</span>
<span id="cb115-50"><a href="#cb115-50" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"N"</span> <span class="sc">~</span> <span class="st">"Negative"</span>,</span>
<span id="cb115-51"><a href="#cb115-51" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"I"</span> <span class="sc">~</span> <span class="st">"Indeterminate"</span>))</span>
<span id="cb115-52"><a href="#cb115-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-53"><a href="#cb115-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Create test-level lab data</span></span>
<span id="cb115-54"><a href="#cb115-54" aria-hidden="true" tabindex="-1"></a>data_lab_tests <span class="ot">&lt;-</span> data_lab <span class="sc">|&gt;</span> </span>
<span id="cb115-55"><a href="#cb115-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(target <span class="sc">!=</span> <span class="st">"Dengue IgG"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb115-56"><a href="#cb115-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sample_id) <span class="sc">|&gt;</span> </span>
<span id="cb115-57"><a href="#cb115-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(value)) <span class="sc">|&gt;</span> </span>
<span id="cb115-58"><a href="#cb115-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb115-59"><a href="#cb115-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb115-60"><a href="#cb115-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-61"><a href="#cb115-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Create case-level lab data</span></span>
<span id="cb115-62"><a href="#cb115-62" aria-hidden="true" tabindex="-1"></a>data_lab_cases <span class="ot">&lt;-</span> data_lab_tests <span class="sc">|&gt;</span> </span>
<span id="cb115-63"><a href="#cb115-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(notification_id) <span class="sc">|&gt;</span> </span>
<span id="cb115-64"><a href="#cb115-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(value)) <span class="sc">|&gt;</span> </span>
<span id="cb115-65"><a href="#cb115-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb115-66"><a href="#cb115-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb115-67"><a href="#cb115-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-68"><a href="#cb115-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Link notification and lab data  ---------------------------------------</span></span>
<span id="cb115-69"><a href="#cb115-69" aria-hidden="true" tabindex="-1"></a>data_linked <span class="ot">&lt;-</span> <span class="fu">left_join</span>(data_notif, data_lab_cases, <span class="at">by =</span> <span class="st">"notification_id"</span>)</span>
<span id="cb115-70"><a href="#cb115-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-71"><a href="#cb115-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean data--------------------------------------------------------------</span></span>
<span id="cb115-72"><a href="#cb115-72" aria-hidden="true" tabindex="-1"></a>data_linked <span class="ot">&lt;-</span> data_linked <span class="sc">|&gt;</span> </span>
<span id="cb115-73"><a href="#cb115-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">case_category =</span> <span class="fu">case_when</span>(value<span class="sc">==</span><span class="st">"Positive"</span> <span class="sc">~</span> <span class="st">"Confirmed"</span>,</span>
<span id="cb115-74"><a href="#cb115-74" aria-hidden="true" tabindex="-1"></a>                                   value<span class="sc">==</span><span class="st">"Negative"</span> <span class="sc">~</span> <span class="st">"Discarded"</span>,</span>
<span id="cb115-75"><a href="#cb115-75" aria-hidden="true" tabindex="-1"></a>                                   value<span class="sc">==</span><span class="st">"Indeterminate"</span> <span class="sc">|</span> <span class="fu">is.na</span>(value) <span class="sc">~</span> <span class="st">"Suspected"</span>))</span>
<span id="cb115-76"><a href="#cb115-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-77"><a href="#cb115-77" aria-hidden="true" tabindex="-1"></a>data_linked_confirmed <span class="ot">&lt;-</span> data_linked <span class="sc">|&gt;</span> </span>
<span id="cb115-78"><a href="#cb115-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(case_category<span class="sc">==</span><span class="st">"Confirmed"</span>)</span>
<span id="cb115-79"><a href="#cb115-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-80"><a href="#cb115-80" aria-hidden="true" tabindex="-1"></a><span class="co"># ANALYSIS ---------------------------------------------------------</span></span>
<span id="cb115-81"><a href="#cb115-81" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of suspected cases in Feveria</span></span>
<span id="cb115-82"><a href="#cb115-82" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(data_notif, disease_notified)</span>
<span id="cb115-83"><a href="#cb115-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-84"><a href="#cb115-84" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribution of suspected cases by district</span></span>
<span id="cb115-85"><a href="#cb115-85" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(data_notif, disease_notified, residential_district) <span class="sc">|&gt;</span></span>
<span id="cb115-86"><a href="#cb115-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_percentages</span>() <span class="sc">|&gt;</span></span>
<span id="cb115-87"><a href="#cb115-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_pct_formatting</span>() <span class="sc">|&gt;</span></span>
<span id="cb115-88"><a href="#cb115-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_ns</span>()</span>
<span id="cb115-89"><a href="#cb115-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-90"><a href="#cb115-90" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribution of results per disease-specific test</span></span>
<span id="cb115-91"><a href="#cb115-91" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(data_lab_tests, test, value) <span class="sc">|&gt;</span> </span>
<span id="cb115-92"><a href="#cb115-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">adorn_totals</span>(<span class="at">where =</span> <span class="st">"col"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb115-93"><a href="#cb115-93" aria-hidden="true" tabindex="-1"></a>    <span class="fu">adorn_percentages</span>() <span class="sc">|&gt;</span> </span>
<span id="cb115-94"><a href="#cb115-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">adorn_pct_formatting</span>() <span class="sc">|&gt;</span> </span>
<span id="cb115-95"><a href="#cb115-95" aria-hidden="true" tabindex="-1"></a>    <span class="fu">adorn_ns</span>()</span>
<span id="cb115-96"><a href="#cb115-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-97"><a href="#cb115-97" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribution of case category, in linked data: all cases</span></span>
<span id="cb115-98"><a href="#cb115-98" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(data_linked, case_category) </span>
<span id="cb115-99"><a href="#cb115-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-100"><a href="#cb115-100" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribution of case category by diseases, in linked data: all cases</span></span>
<span id="cb115-101"><a href="#cb115-101" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(data_linked, disease_notified, case_category) <span class="sc">|&gt;</span> </span>
<span id="cb115-102"><a href="#cb115-102" aria-hidden="true" tabindex="-1"></a>    <span class="fu">adorn_totals</span>(<span class="at">where =</span> <span class="st">"both"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb115-103"><a href="#cb115-103" aria-hidden="true" tabindex="-1"></a>    <span class="fu">adorn_percentages</span>() <span class="sc">|&gt;</span> </span>
<span id="cb115-104"><a href="#cb115-104" aria-hidden="true" tabindex="-1"></a>    <span class="fu">adorn_pct_formatting</span>() <span class="sc">|&gt;</span> </span>
<span id="cb115-105"><a href="#cb115-105" aria-hidden="true" tabindex="-1"></a>    <span class="fu">adorn_ns</span>()</span>
<span id="cb115-106"><a href="#cb115-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-107"><a href="#cb115-107" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribution of case category by disease, in linked data: only cases with a valid result</span></span>
<span id="cb115-108"><a href="#cb115-108" aria-hidden="true" tabindex="-1"></a>data_linked <span class="sc">|&gt;</span> </span>
<span id="cb115-109"><a href="#cb115-109" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(case_category <span class="sc">!=</span> <span class="st">"Suspected"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb115-110"><a href="#cb115-110" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabyl</span>(disease_notified, case_category) <span class="sc">|&gt;</span> </span>
<span id="cb115-111"><a href="#cb115-111" aria-hidden="true" tabindex="-1"></a>    <span class="fu">adorn_totals</span>(<span class="at">where =</span> <span class="st">"both"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb115-112"><a href="#cb115-112" aria-hidden="true" tabindex="-1"></a>    <span class="fu">adorn_percentages</span>() <span class="sc">|&gt;</span> </span>
<span id="cb115-113"><a href="#cb115-113" aria-hidden="true" tabindex="-1"></a>    <span class="fu">adorn_pct_formatting</span>() <span class="sc">|&gt;</span> </span>
<span id="cb115-114"><a href="#cb115-114" aria-hidden="true" tabindex="-1"></a>    <span class="fu">adorn_ns</span>()</span>
<span id="cb115-115"><a href="#cb115-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-116"><a href="#cb115-116" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribution of confirmed cases by district</span></span>
<span id="cb115-117"><a href="#cb115-117" aria-hidden="true" tabindex="-1"></a>data_linked_confirmed <span class="sc">|&gt;</span> </span>
<span id="cb115-118"><a href="#cb115-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(disease_notified, residential_district) <span class="sc">|&gt;</span> </span>
<span id="cb115-119"><a href="#cb115-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(<span class="at">where =</span> <span class="st">"both"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb115-120"><a href="#cb115-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_percentages</span>() <span class="sc">|&gt;</span> </span>
<span id="cb115-121"><a href="#cb115-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_pct_formatting</span>() <span class="sc">|&gt;</span> </span>
<span id="cb115-122"><a href="#cb115-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_ns</span>() </span>
<span id="cb115-123"><a href="#cb115-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-124"><a href="#cb115-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-125"><a href="#cb115-125" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize confirmed cases over time</span></span>
<span id="cb115-126"><a href="#cb115-126" aria-hidden="true" tabindex="-1"></a>data_linked_confirmed <span class="sc">|&gt;</span> </span>
<span id="cb115-127"><a href="#cb115-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb115-128"><a href="#cb115-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>((<span class="fu">aes</span>(<span class="at">x =</span> date_report, <span class="at">fill =</span> residential_district)), <span class="at">binwidth=</span><span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb115-129"><a href="#cb115-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span>disease_notified, <span class="at">ncol=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb115-130"><a href="#cb115-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb115-131"><a href="#cb115-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"District of residence"</span>,</span>
<span id="cb115-132"><a href="#cb115-132" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Date reported by clinic"</span>,</span>
<span id="cb115-133"><a href="#cb115-133" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>,</span>
<span id="cb115-134"><a href="#cb115-134" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Number of confirmed cholera, dengue, malaria, typhoid fever, and yellow fever cases by week in Feveria, 2024"</span>) <span class="sc">+</span></span>
<span id="cb115-135"><a href="#cb115-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"navy"</span>, <span class="st">"lightblue"</span>, <span class="st">"seagreen"</span>)) <span class="sc">+</span></span>
<span id="cb115-136"><a href="#cb115-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_breaks =</span> <span class="st">"1 month"</span>, </span>
<span id="cb115-137"><a href="#cb115-137" aria-hidden="true" tabindex="-1"></a>               <span class="at">date_labels =</span> <span class="st">"%d %b"</span>) <span class="sc">+</span></span>
<span id="cb115-138"><a href="#cb115-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>,</span>
<span id="cb115-139"><a href="#cb115-139" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>)) </span>
<span id="cb115-140"><a href="#cb115-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-141"><a href="#cb115-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-142"><a href="#cb115-142" aria-hidden="true" tabindex="-1"></a><span class="co"># First and last report date per disease</span></span>
<span id="cb115-143"><a href="#cb115-143" aria-hidden="true" tabindex="-1"></a>data_linked_confirmed <span class="sc">|&gt;</span> </span>
<span id="cb115-144"><a href="#cb115-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(disease_notified) <span class="sc">|&gt;</span> </span>
<span id="cb115-145"><a href="#cb115-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">first_reported =</span> <span class="fu">min</span>(date_report), </span>
<span id="cb115-146"><a href="#cb115-146" aria-hidden="true" tabindex="-1"></a>            <span class="at">last_reported =</span> <span class="fu">max</span>(date_report)) <span class="sc">|&gt;</span></span>
<span id="cb115-147"><a href="#cb115-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="case-study-information" class="level2">
<h2 class="anchored" data-anchor-id="case-study-information">Case study information</h2>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Original authors</strong>: Paula Blomquist and Alanah Jansen, with technical support provided by the CDC Global Surveillance, Laboratory, and Data Systems Branch in collaboration with TEPHINET.</p>
<p><strong>Data source</strong>: Fictional data provided by Applied Epi.</p>
</div>
</div>
</div>
<table class="caption-top table">
<colgroup>
<col style="width: 19%">
<col style="width: 19%">
<col style="width: 19%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th>Date</th>
<th style="text-align: left;">Changes made</th>
<th style="text-align: right;">Version</th>
<th>Author</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>July 2025</td>
<td style="text-align: left;">First draft</td>
<td style="text-align: right;">1</td>
<td>Paula Blomquist and Alanah Jansen, Applied Epi, with technical support by the CDC Global Surveillance, Laboratory, and Data Systems Branch in collaboration with TEPHINET</td>
</tr>
</tbody>
</table>
</section>
<section id="terms-of-use" class="level2">
<h2 class="anchored" data-anchor-id="terms-of-use">Terms of Use</h2>
<p><strong>Disclaimer</strong>: The information presented in this exercise and the associated data files have been developed to help learners achieve the intended learning objectives. The contents are those of the author(s) and do not necessarily represent the official views of CDC, the US Department of Health and Human Services, or TEPHINET.</p>
<p><strong>License</strong>: This case study is under a <a href="https://github.com/appliedepi/case_studies/tree/master/licenses/multi_disease_lab_LICENSE.md">CC BY-NC-SA 4.0 license</a>. For more information about sharing and adapting this case study, see the <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">associated deed</a>.</p>
<p><strong>Funding</strong>: This case study was 100% supported by Cooperative Agreement number NU2HGH000044 funded by the US Centers for Disease Control and Prevention (CDC).</p>


</section>
</section>

</main> <!-- /main -->
<script>



/* update total correct if #webex-total_correct exists */

update_total_correct = function() {

  console.log("webex: update total_correct");



  var t = document.getElementsByClassName("webex-total_correct");

  for (var i = 0; i < t.length; i++) {

    p = t[i].parentElement;

    var correct = p.getElementsByClassName("webex-correct").length;

    var solvemes = p.getElementsByClassName("webex-solveme").length;

    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;

    var selects = p.getElementsByClassName("webex-select").length;



    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";

  }

}



/* webex-solution button toggling function */

b_func = function() {

  console.log("webex: toggle hide");



  var cl = this.parentElement.classList;

  if (cl.contains('open')) {

    cl.remove("open");

  } else {

    cl.add("open");

  }

}



/* check answers */

check_func = function() {

  console.log("webex: check answers");



  var cl = this.parentElement.classList;

  if (cl.contains('unchecked')) {

    cl.remove("unchecked");

    this.innerHTML = "Hide Answers";

  } else {

    cl.add("unchecked");

    this.innerHTML = "Show Answers";

  }

}



/* function for checking solveme answers */

solveme_func = function(e) {

  console.log("webex: check solveme");



  var real_answers = JSON.parse(this.dataset.answer);

  var my_answer = this.value;

  var cl = this.classList;

  if (cl.contains("ignorecase")) {

    my_answer = my_answer.toLowerCase();

  }

  if (cl.contains("nospaces")) {

    my_answer = my_answer.replace(/ /g, "")

  }



  if (my_answer == "") {

    cl.remove("webex-correct");

    cl.remove("webex-incorrect");

  } else if (real_answers.includes(my_answer)) {

    cl.add("webex-correct");

    cl.remove("webex-incorrect");

  } else {

    cl.add("webex-incorrect");

    cl.remove("webex-correct");

  }



  // match numeric answers within a specified tolerance

  if(this.dataset.tol > 0){

    var tol = JSON.parse(this.dataset.tol);

    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)

    if (matches.reduce((a, b) => a + b, 0) > 0) {

      cl.add("webex-correct");

    } else {

      cl.remove("webex-correct");

    }

  }



  // added regex bit

  if (cl.contains("regex")){

    answer_regex = RegExp(real_answers.join("|"))

    if (answer_regex.test(my_answer)) {

      cl.add("webex-correct");

    }

  }



  update_total_correct();

}



/* function for checking select answers */

select_func = function(e) {

  console.log("webex: check select");



  var cl = this.classList



  /* add style */

  cl.remove("webex-incorrect");

  cl.remove("webex-correct");

  if (this.value == "answer") {

    cl.add("webex-correct");

  } else if (this.value != "blank") {

    cl.add("webex-incorrect");

  }



  update_total_correct();

}



/* function for checking radiogroups answers */

radiogroups_func = function(e) {

  console.log("webex: check radiogroups");



  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');

  var cl = checked_button.parentElement.classList;

  var labels = checked_button.parentElement.parentElement.children;



  /* get rid of styles */

  for (i = 0; i < labels.length; i++) {

    labels[i].classList.remove("webex-incorrect");

    labels[i].classList.remove("webex-correct");

  }



  /* add style */

  if (checked_button.value == "answer") {

    cl.add("webex-correct");

  } else {

    cl.add("webex-incorrect");

  }



  update_total_correct();

}



window.onload = function() {

  console.log("webex onload");

  /* set up solution buttons */

  var buttons = document.getElementsByTagName("button");



  for (var i = 0; i < buttons.length; i++) {

    if (buttons[i].parentElement.classList.contains('webex-solution')) {

      buttons[i].onclick = b_func;

    }

  }



  var check_sections = document.getElementsByClassName("webex-check");

  console.log("check:", check_sections.length);

  for (var i = 0; i < check_sections.length; i++) {

    check_sections[i].classList.add("unchecked");



    let btn = document.createElement("button");

    btn.innerHTML = "Show Answers";

    btn.classList.add("webex-check-button");

    btn.onclick = check_func;

    check_sections[i].appendChild(btn);



    let spn = document.createElement("span");

    spn.classList.add("webex-total_correct");

    check_sections[i].appendChild(spn);

  }



  /* set up webex-solveme inputs */

  var solveme = document.getElementsByClassName("webex-solveme");



  for (var i = 0; i < solveme.length; i++) {

    /* make sure input boxes don't auto-anything */

    solveme[i].setAttribute("autocomplete","off");

    solveme[i].setAttribute("autocorrect", "off");

    solveme[i].setAttribute("autocapitalize", "off");

    solveme[i].setAttribute("spellcheck", "false");

    solveme[i].value = "";



    /* adjust answer for ignorecase or nospaces */

    var cl = solveme[i].classList;

    var real_answer = solveme[i].dataset.answer;

    if (cl.contains("ignorecase")) {

      real_answer = real_answer.toLowerCase();

    }

    if (cl.contains("nospaces")) {

      real_answer = real_answer.replace(/ /g, "");

    }

    solveme[i].dataset.answer = real_answer;



    /* attach checking function */

    solveme[i].onkeyup = solveme_func;

    solveme[i].onchange = solveme_func;



    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")

  }



  /* set up radiogroups */

  var radiogroups = document.getElementsByClassName("webex-radiogroup");

  for (var i = 0; i < radiogroups.length; i++) {

    radiogroups[i].onchange = radiogroups_func;

  }



  /* set up selects */

  var selects = document.getElementsByClassName("webex-select");

  for (var i = 0; i < selects.length; i++) {

    selects[i].onchange = select_func;

    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")

  }



  update_total_correct();

}



</script>

<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">

<div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>